"use strict";(self.webpackChunkfusioncms=self.webpackChunkfusioncms||[]).push([[1315],{1315:(e,t,r)=>{r.r(t),r.d(t,{default:()=>u,getBlueprint:()=>o});var n=r(8401);const s={data:function(){return{placements:[{label:"Body",value:"body"},{label:"Sidebar",value:"sidebar"}]}},props:{resource:{type:Object,required:!1,default:function(){}},form:{type:Object,required:!0},loading:{type:Boolean,required:!1}},methods:{remove:function(){var e=this.$store.getters["blueprint/getRemoveIndex"];this.form.sections.length>0&&this.form.sections.splice(e,1)}},created:function(){this.$store.commit("fieldtypes/setStructure",this.resource.structure.toLowerCase())}};var a=r(1900);function o(e,t){axios.get("/api/blueprints/"+e).then((function(e){t(null,e.data.data)})).catch((function(e){t(new Error("The requested blueprint could not be found"))}))}const i={auth:function(){return{permission:"blueprints.update"}},head:{title:function(){return{inner:_.has(this.form,"name")?this.form.name:"Loading..."}}},data:function(){return{id:null,resource:null,form:null,loading:!1}},components:{"shared-form":(0,a.Z)(s,(function(){var e=this,t=e._self._c;return t("div",[t("portal",{attrs:{to:"actions"}},[t("div",{staticClass:"buttons"},["sm"!=e.$mq?t("ui-button",{attrs:{to:{name:"blueprints"},variant:"secondary"}},[e._v("Go Back")]):e._e(),e._v(" "),t("ui-button",{attrs:{type:"submit",variant:"primary",disabled:!e.form.hasChanges||e.loading},on:{click:function(t){return t.preventDefault(),e.$parent.submit.apply(null,arguments)}}},[e._v("Save")])],1)]),e._v(" "),t("portal",{attrs:{to:"sidebar-right"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"! loading"}]},[t("sidebar",{attrs:{id:"blueprint-sidebar"}},[e.resource?t("status-card",{attrs:{entry:e.resource,id:"blueprint_panel_status_card",tabindex:"-1"}}):e._e()],1)],1)]),e._v(" "),t("section-card",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],attrs:{title:"Loading..."}}),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"! loading"}]},[t("div",{staticClass:"card"},[t("div",{staticClass:"card__body"},[t("ui-title-group",{attrs:{name:"name",readonly:"","has-error":e.form.errors.has("name"),"error-message":e.form.errors.get("name")},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),e._v(" "),t("blueprint",{attrs:{placements:e.placements,form:e.form}})],1)])])],1)}),[],!1,null,null,null).exports},methods:{submit:function(){var e=this;this.loading=!0,this.form.patch("/api/blueprints/".concat(this.resource.id)).then((function(){axios.post("/api/blueprints/".concat(e.resource.id,"/sections"),{sections:e.form.sections}).then((function(){toast("Blueprint successfully updated","success"),e.$router.push("/blueprints")})).catch((function(t){toast(t.message,"failed"),e.loading=!1}))})).catch((function(t){toast(t.response.data.message,"failed"),e.loading=!1}))}},beforeRouteEnter:function(e,t,r){o(e.params.blueprint,(function(e,t){r(e?function(t){t.$router.push("/blueprints"),toast(e.toString(),"danger")}:function(e){e.resource=t,e.form=new n.Z({name:t.name,sections:t.sections},!0),e.$nextTick((function(){e.$emit("updateHead")}))})}))}};const u=(0,a.Z)(i,(function(){var e=this,t=e._self._c;return t("div",[t("portal",{attrs:{to:"title"}},[t("page-title",{attrs:{icon:"list"}},[e._v("Edit Blueprint")])],1),e._v(" "),e.form?t("shared-form",{attrs:{loading:e.loading,form:e.form,resource:e.resource}}):e._e()],1)}),[],!1,null,null,null).exports}}]);