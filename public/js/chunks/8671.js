"use strict";(self.webpackChunkfusioncms=self.webpackChunkfusioncms||[]).push([[8671],{8671:(n,e,t)=>{t.r(e),t.d(e,{default:()=>r,getLink:()=>a});var i=t(8401);function a(n,e,t){axios.all([axios.get("/api/navigation/"+n+"/links/"+e),axios.get("/api/navigation/"+n)]).then(axios.spread((function(n,e){n=n.data.data,e=e.data.data;var i={name:n.name,url:n.url,new_window:Number(n.new_window).toString(),parent_id:n.parent_id,order:n.order,status:n.status};_.forEach(e.blueprint.sections,(function(e){_.forEach(e.fields,(function(e){i[e.handle]=n[e.handle]}))})),t(null,n,e,i)})))}const o={auth:function(){return{permission:"links.update"}},components:{"shared-form":t(3264).Z},data:function(){return{navigation:{},link:{},links:[],form:new i.Z({name:"",url:"",new_window:!1,parent_id:0,order:0,status:!1},!0),loading:!1}},methods:{submit:function(){var n=this;this.loading=!0,this.form.patch("/api/navigation/"+this.navigation.id+"/links/"+this.link.id).then((function(e){toast("Link saved successfully","success"),n.$router.push("/navigation/"+n.navigation.id+"/links")})).catch((function(e){toast(e.message,"failed"),n.loading=!1}))}},beforeRouteEnter:function(n,e,t){a(n.params.navigation,n.params.link,(function(n,e,a,o){t(n?function(e){e.$router.push("/navigation"),toast(n.toString(),"danger")}:function(n){n.navigation=a,n.link=e,n.form=new i.Z(o,!0),n.links=_.map(a.links,(function(n){return{label:n.name,value:n.id}})),n.links.unshift({label:"None",value:0}),n.$emit("updateHead")})}))}};const r=(0,t(1900).Z)(o,(function(){var n=this,e=n._self._c;return e("div",[e("portal",{attrs:{to:"title"}},[e("page-title",{attrs:{icon:"anchor"}},[n._v("Edit Link")])],1),n._v(" "),e("shared-form",{attrs:{loading:n.loading,form:n.form,submit:n.submit,navigation:n.navigation,link:n.link,links:n.links}})],1)}),[],!1,null,null,null).exports},3264:(n,e,t)=>{t.d(e,{Z:()=>a});const i={props:{link:{type:Object,default:function(){return{}}},links:{type:Array,required:!0},navigation:{type:Object,required:!0},form:{type:Object,required:!0},submit:{required:!0},loading:{type:Boolean,required:!1}},computed:{sections:function(){var n=[],e=[];return this.navigation.blueprint&&(n=_.filter(this.navigation.blueprint.sections,(function(n){return"body"==n.placement})),e=_.filter(this.navigation.blueprint.sections,(function(n){return"sidebar"==n.placement}))),{body:n,sidebar:e}},fields:function(){var n=[],e=[];return this.navigation.blueprint&&(n=_.filter(this.navigation.blueprint.sections,(function(n){return"body"==n.placement})),n=_.flatMap(n,(function(n){return n.fields})),e=_.filter(this.navigation.blueprint.sections,(function(n){return"sidebar"==n.placement})),e=_.flatMap(e,(function(n){return n.fields}))),{body:n,sidebar:e}}}};const a=(0,t(1900).Z)(i,(function(){var n=this,e=n._self._c;return e("div",[e("portal",{attrs:{to:"actions"}},[e("div",{staticClass:"buttons"},[n.navigation.id&&"sm"!=n.$mq?e("ui-button",{attrs:{to:{name:"links",params:{navigation:n.navigation.id}},variant:"secondary"}},[n._v("Go Back")]):n._e(),n._v(" "),e("ui-button",{attrs:{type:"submit",variant:"primary",disabled:!n.form.hasChanges||n.loading},on:{click:function(e){return e.preventDefault(),n.submit.apply(null,arguments)}}},[n._v("Save")])],1)]),n._v(" "),e("section-card",{directives:[{name:"show",rawName:"v-show",value:n.loading,expression:"loading"}],attrs:{title:"Loading..."}}),n._v(" "),e("portal",{attrs:{to:"sidebar-right"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:!n.loading,expression:"! loading"}]},[e("sidebar",{attrs:{id:"link-sidebar"}},[e("sidebar-section",{attrs:{id:"link_panel_status",tabindex:"-1"}},[e("ui-toggle",{attrs:{name:"status",label:"Status",help:n.form.status?"Toggle to disable this link.":"Toggle to enable this link.","true-value":!0,"false-value":!1},model:{value:n.form.status,callback:function(e){n.$set(n.form,"status",e)},expression:"form.status"}}),n._v(" "),e("ui-select-group",{attrs:{name:"new_window",label:"Open link where",help:"Determine where the link should open.",options:[{label:"New Window",value:"1"},{label:"Same Window",value:"0"}]},model:{value:n.form.new_window,callback:function(e){n.$set(n.form,"new_window",e)},expression:"form.new_window"}})],1)],1)],1)]),n._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!n.loading,expression:"! loading"}]},[e("ui-card",{attrs:{id:"link_panel",tabindex:"-1"}},[e("ui-card-body",[e("ui-title-group",{attrs:{name:"name",label:"Name",autocomplete:"off",autofocus:"",required:"","has-error":n.form.errors.has("name"),"error-message":n.form.errors.get("name")},model:{value:n.form.name,callback:function(e){n.$set(n.form,"name",e)},expression:"form.name"}}),n._v(" "),e("ui-input-group",{attrs:{name:"url",label:"URL",help:"The URL of the link.",autocomplete:"off","has-error":n.form.errors.has("url"),"error-message":n.form.errors.get("url")},model:{value:n.form.url,callback:function(e){n.$set(n.form,"url",e)},expression:"form.url"}})],1)],1),n._v(" "),n._l(n.sections.body,(function(t){return e("section-card",{key:t.handle,attrs:{id:"collection_panel_"+t.handle,title:t.name,description:t.description,tabindex:"-1"}},[t.fields.length>0?e("div",n._l(t.fields,(function(t){return e(t.type.id+"-fieldtype",{key:t.handle,tag:"component",attrs:{field:t,errors:n.form.errors},model:{value:n.form[t.handle],callback:function(e){n.$set(n.form,t.handle,e)},expression:"form[field.handle]"}})})),1):n._e()])}))],2)],1)}),[],!1,null,null,null).exports}}]);