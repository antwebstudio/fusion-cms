"use strict";(self.webpackChunkfusioncms=self.webpackChunkfusioncms||[]).push([[2489],{2489:(e,t,o)=>{o.r(t),o.d(t,{default:()=>v});var n=o(3802),a={class:"row"},r={class:"content-container"},l={class:"row"},i={class:"card"},c=["src","alt"],s={class:"card__body"},d={class:"font-bold text-xl mb-2"},u={class:"text-gray-800 text-base"},m={class:"w-full border-t-2 border-gray-200 pt-3"},p={key:1,class:"text-center"},f=(0,n.createElementVNode)("p",null,"Are you sure you want to override this theme? The existing theme will be discarded.",-1);const h={head:{title:function(){return{inner:"Theme"}}},data:function(){return{themes:[],confirmModal:!1,uploadForm:null}},methods:{setAsActive:function(e){var t=this;axios.patch("/api/theme/".concat(e)).then((function(){_.each(t.themes,(function(t){t.active=t.namespace===e})),toast("Active theme has been set","success")}))},refresh:function(){axios.all([axios.get("/api/themes")]).then(axios.spread(function(e){this.themes=e.data.data,this.uploadForm=null,this.confirmModal=!1}.bind(this)))},submitUpload:function(){var e=this;axios.post("/api/themes",this.uploadForm).then((function(t){toast("Theme successfully uploaded!","success"),e.confirmModal=!1,e.$refs.upload.remove(),e.refresh()}))},confirmUpload:function(){this.confirmModal=!0},cancelUpload:function(){this.confirmModal=!1,this.$refs.upload.remove()},verifyUpload:function(e){var t=this;void 0!==e&&(this.uploadForm=new FormData,this.uploadForm.append("_method","POST"),this.uploadForm.append("file-upload",e),axios.post("/api/themes/verify",this.uploadForm).then((function(e){t.submitUpload()})).catch((function(e){"A Theme with matching name already exists."==e.response.data.errors["file-upload"][0]?t.confirmUpload():(toast(e.response.data.message,"failed"),t.$refs.upload.remove(),t.$refs.upload.setError(e.response.data.errors["file-upload"][0]))})))}},beforeRouteEnter:function(e,t,o){o((function(e){e.refresh()}))}};const v=(0,o(3744).Z)(h,[["render",function(e,t,o,h,v,x){var k=(0,n.resolveComponent)("page-title"),C=(0,n.resolveComponent)("portal"),V=(0,n.resolveComponent)("ui-upload"),w=(0,n.resolveComponent)("ui-button"),N=(0,n.resolveComponent)("router-link"),b=(0,n.resolveComponent)("ui-modal");return(0,n.openBlock)(),(0,n.createElementBlock)("div",null,[(0,n.createVNode)(C,{to:"title"},{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(k,{icon:"palette"},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)("Theme")]}),void 0,!0),_:1})]}),void 0,!0),_:1}),(0,n.createElementVNode)("div",a,[(0,n.createElementVNode)("div",r,[(0,n.createVNode)(V,{name:"file-upload",label:"Upload",ref:"upload",accept:"zip",multiple:!1,onInput:x.verifyUpload},null,8,["onInput"])])]),(0,n.createElementVNode)("div",l,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(v.themes,(function(e){return(0,n.openBlock)(),(0,n.createElementBlock)("div",{class:"col mb-6 md:w-1/2 xl:w-1/4",key:e.name},[(0,n.createElementVNode)("div",i,[(0,n.createElementVNode)("img",{class:"w-full rounded-t shadow",src:e.preview,alt:e.name},null,8,c),(0,n.createElementVNode)("div",s,[(0,n.createElementVNode)("div",d,(0,n.toDisplayString)(e.name),1),(0,n.createElementVNode)("p",u,(0,n.toDisplayString)(e.description),1),(0,n.createElementVNode)("div",m,[e.active?((0,n.openBlock)(),(0,n.createElementBlock)("p",p,"Currently Active")):((0,n.openBlock)(),(0,n.createBlock)(w,{key:0,class:"w-full",onClick:function(t){return x.setAsActive(e.namespace)}},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)("Set as active")]}),void 0,!0),_:2},1032,["onClick"]))])])])])})),128))]),(0,n.createVNode)(C,{to:"actions"},{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(N,{to:{name:"dashboard"},class:"button"},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)("Go Back")]}),void 0,!0),_:1})]}),void 0,!0),_:1}),(0,n.createVNode)(b,{name:"confirm",title:"Confirm override",key:"confirm_modal",modelValue:v.confirmModal,"onUpdate:modelValue":t[0]||(t[0]=function(e){return v.confirmModal=e})},{footer:(0,n.withCtx)((function(){return[(0,n.createVNode)(w,{onClick:x.submitUpload,type:"button",variant:"primary"},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)("Yes, please!")]}),void 0,!0),_:1},8,["onClick"]),(0,n.createVNode)(w,{onClick:x.cancelUpload,type:"button",class:"mr-3"},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)("Leave and Discard Changes")]}),void 0,!0),_:1},8,["onClick"])]})),default:(0,n.withCtx)((function(){return[f]}),void 0,!0),_:1},8,["modelValue"])])}]])}}]);