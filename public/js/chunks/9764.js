"use strict";(self.webpackChunkfusioncms=self.webpackChunkfusioncms||[]).push([[9764],{1381:(e,t,r)=>{r.d(t,{Z:()=>o});const o={methods:{isAssignable:function(e,t){return!_.includes(["guest"],e)&&this.$level(t)},isRemovable:function(e,t){return!_.includes(["owner","user","guest"],e)&&this.$level(t)},hasPermissions:function(e){return!_.includes(["owner"],e)}}}},9764:(e,t,r)=>{r.r(t),r.d(t,{default:()=>l,getUserAndRoles:()=>n});var o=r(3802),s={class:"user-page"};var a=r(8401);const i={auth:function(){return{permission:"users.update",level:this.getAuthLevel()}},head:{title:function(){return{inner:this.user.name||"Loading..."}}},data:function(){return{user:{},roles:[],form:null,loading:!1}},components:{"shared-form":r(6469).Z},methods:{getAuthLevel:function(){return this.$user.id!=this.user.id&&(!!this.user.role&&this.user.role.level)},submit:function(){var e=this;this.loading=!0,this.form.patch("/api/users/".concat(this.user.id)).then((function(t){toast("User successfully updated","success"),e.$router.push("/users")})).catch((function(t){toast(t.message,"failed"),e.loading=!1}))}},beforeRouteEnter:function(e,t,r){n(e.params.user,(function(e,t,o,s){r(e?function(t){t.$router.push("/users"),toast(e.toString(),"danger")}:function(e){e.user=t,e.roles=o,e.form=new a.Z(s,!0),e.$emit("updateHead"),e.$emit("updateAuth")})}))}};function n(e,t){axios.all([axios.get("/api/roles"),axios.get("/api/users/"+e)]).then(axios.spread((function(e,r){r=r.data.data,e=e.data.data,t(null,r,e,{name:r.name,email:r.email,status:r.status,role:r.role.handle,password:"",password_confirmation:"",subscriptions:r.subscriptions})})))}const l=(0,r(3744).Z)(i,[["render",function(e,t,r,a,i,n){var l=(0,o.resolveComponent)("page-title"),u=(0,o.resolveComponent)("portal"),d=(0,o.resolveComponent)("shared-form");return(0,o.openBlock)(),(0,o.createElementBlock)("div",s,[(0,o.createVNode)(u,{to:"title"},{default:(0,o.withCtx)((function(){return[(0,o.createVNode)(l,{icon:"user-alt"},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Edit User")]}),void 0,!0),_:1})]}),void 0,!0),_:1}),i.form?((0,o.openBlock)(),(0,o.createBlock)(d,{key:0,loading:i.loading,form:i.form,roles:i.roles,user:i.user,submit:n.submit},null,8,["loading","form","roles","user","submit"])):(0,o.createCommentVNode)("",!0)])}]])},6469:(e,t,r)=>{r.d(t,{Z:()=>b});var o=r(3802),s={class:"buttons"},a={class:"mb-4"},i=(0,o.createElementVNode)("span",{class:"label"},"Verification Email",-1),n=(0,o.createElementVNode)("p",{class:"help mb-2"},"Re-send the verification email to this user.",-1),l={class:"mb-4"},u=(0,o.createElementVNode)("span",{class:"label"},"Password Reset",-1),d=(0,o.createElementVNode)("p",{class:"help mb-2"},"Re-send password reset email to this user.",-1),c={class:"mb-4"},m=(0,o.createElementVNode)("span",{class:"label"},"Expire Password",-1),f=(0,o.createElementVNode)("p",{class:"help mb-2"},"Force the user to reset their password upon next login attempt.",-1),p={class:"mb-4"},h=(0,o.createElementVNode)("span",{class:"label"},"Delete User",-1),v=(0,o.createElementVNode)("p",{class:"help mb-2"},"Once you delete this user, there is no going back. Please be certain.",-1),w=(0,o.createElementVNode)("p",null,"Are you sure you want to re-send the verification email to this user?",-1),V=(0,o.createElementVNode)("p",null,"Are you sure you want to send this user a password reset notification?",-1),x=(0,o.createElementVNode)("p",null,"Are you sure you want to force user to reset their password upon next login?",-1),C=(0,o.createElementVNode)("p",null,"Are you sure you want to permenantly delete this user?",-1);const g={mixins:[r(1381).Z],props:{form:{type:Object,required:!0},submit:{required:!0},roles:{type:Array,required:!0},user:{type:Object,required:!1},loading:{type:Boolean,required:!1}},computed:{roleOptions:function(){var e=this,t=_.filter(this.roles,(function(t){return e.isAssignable(t.name,t.level)}));return _.map(t,(function(e){return{label:e.name,value:e.handle}}))},canEditPassword:function(){return this.user&&this.$store.state.auth.user&&this.user.id==this.$store.state.auth.user.id}},methods:{destroy:function(){var e=this;axios.delete("/api/users/".concat(this.user.id)).then((function(t){toast("User successfully removed from system.","success"),e.$router.push("/users")})).catch((function(e){toast(e.response.data.message,"failed")}))},emailVerification:function(){axios.post("/api/users/".concat(this.user.id,"/verify")).then((function(e){toast("Email verification notification has been sent to user.","success")})).catch((function(e){toast(e.response.data.message,"failed")}))},passwordReset:function(){axios.post("/api/users/".concat(this.user.id,"/reset-password")).then((function(e){toast("Password reset notification has been sent to user.","success")})).catch((function(e){toast(e.response.data.message,"failed")}))},passwordExpire:function(){axios.post("/api/users/".concat(this.user.id,"/expire-password")).then((function(e){toast("User password has been set as expired.","success")})).catch((function(e){toast(e.response.data.message,"failed")}))}}};const b=(0,r(3744).Z)(g,[["render",function(e,t,r,g,b,N){var k=(0,o.resolveComponent)("ui-button"),_=(0,o.resolveComponent)("portal"),y=(0,o.resolveComponent)("section-card"),B=(0,o.resolveComponent)("ui-toggle"),E=(0,o.resolveComponent)("sidebar-section"),D=(0,o.resolveComponent)("sidebar"),T=(0,o.resolveComponent)("ui-input-group"),U=(0,o.resolveComponent)("ui-select-group"),P=(0,o.resolveComponent)("user-notifications"),A=(0,o.resolveComponent)("ui-password-group"),R=(0,o.resolveComponent)("ui-fieldset"),$=(0,o.resolveComponent)("ui-modal"),q=(0,o.resolveDirective)("modal");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createVNode)(_,{to:"actions"},{default:(0,o.withCtx)((function(){return[(0,o.createElementVNode)("div",s,["sm"!=e.$mq?((0,o.openBlock)(),(0,o.createBlock)(k,{key:"go-back-btn",to:{name:"users"},variant:"secondary"},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Go Back")]}),void 0,!0),_:1})):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(k,{key:"save-btn",variant:"primary",onClick:(0,o.withModifiers)(r.submit,["prevent"]),disabled:!r.form.hasChanges||r.loading},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Save")]}),void 0,!0),_:1},8,["onClick","disabled"])])]}),void 0,!0),_:1}),(0,o.withDirectives)((0,o.createVNode)(y,{title:"Loading..."},null,512),[[o.vShow,r.loading]]),(0,o.createVNode)(_,{to:"sidebar-right"},{default:(0,o.withCtx)((function(){return[(0,o.withDirectives)((0,o.createElementVNode)("div",null,[(0,o.createVNode)(D,{id:"users-sidebar"},{default:(0,o.withCtx)((function(){return[(0,o.createVNode)(E,{id:"users_panel_status",tabindex:"-1"},{default:(0,o.withCtx)((function(){return[(0,o.createVNode)(B,{id:"user-status",name:"status",label:"Status",help:r.form.status?"Toggle to disable this user.":"Toggle to enable this user.",modelValue:r.form.status,"onUpdate:modelValue":t[0]||(t[0]=function(e){return r.form.status=e}),"true-value":1,"false-value":0},null,8,["help","modelValue"])]}),void 0,!0),_:1}),r.user?((0,o.openBlock)(),(0,o.createBlock)(E,{key:0,title:"Actions",description:"Management actions that can be performed for this user.",tabindex:"-1"},{default:(0,o.withCtx)((function(){return[(0,o.createElementVNode)("div",a,[i,n,(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(k,{size:"small",variant:"secondary"},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Send Verification")]}),void 0,!0),_:1})),[[q,void 0,"verify-user"]])]),(0,o.createElementVNode)("div",l,[u,d,(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(k,{size:"small",variant:"secondary"},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Reset Password")]}),void 0,!0),_:1})),[[q,void 0,"password-user"]])]),(0,o.createElementVNode)("div",c,[m,f,(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(k,{size:"small",variant:"secondary"},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Expire Password")]}),void 0,!0),_:1})),[[q,void 0,"expire-password"]])]),(0,o.createElementVNode)("div",p,[h,v,(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(k,{size:"small",variant:"danger"},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Delete User")]}),void 0,!0),_:1})),[[q,void 0,"delete-user"]])])]}),void 0,!0),_:1})):(0,o.createCommentVNode)("",!0)]}),void 0,!0),_:1})],512),[[o.vShow,!r.loading]])]}),void 0,!0),_:1}),(0,o.withDirectives)((0,o.createElementVNode)("div",null,[(0,o.createVNode)(y,{id:"user_panel_general",title:"General Information",description:"General information about this user.",tabindex:"-1"},{default:(0,o.withCtx)((function(){return[(0,o.createVNode)(T,{id:"user-name",name:"name",label:"Name",autocomplete:"off",autofocus:"",required:"","has-error":r.form.errors.has("name"),"error-message":r.form.errors.get("name"),modelValue:r.form.name,"onUpdate:modelValue":t[1]||(t[1]=function(e){return r.form.name=e})},null,8,["has-error","error-message","modelValue"]),(0,o.createVNode)(T,{id:"user-id",type:"email",name:"email",label:"E-mail",autocomplete:"off","has-error":r.form.errors.has("email"),"error-message":r.form.errors.get("email"),required:"",modelValue:r.form.email,"onUpdate:modelValue":t[2]||(t[2]=function(e){return r.form.email=e})},null,8,["has-error","error-message","modelValue"])]}),void 0,!0),_:1}),(0,o.createVNode)(y,{id:"user_panel_permissions",title:"Permissions",description:"Select the role to determine which areas of the website this user can access.",tabindex:"-1"},{default:(0,o.withCtx)((function(){return[(0,o.createVNode)(U,{id:"user-role",name:"role",label:"Role",options:N.roleOptions,autocomplete:"off","has-error":r.form.errors.has("role"),"error-message":r.form.errors.get("role"),required:"",modelValue:r.form.role,"onUpdate:modelValue":t[3]||(t[3]=function(e){return r.form.role=e})},null,8,["options","has-error","error-message","modelValue"])]}),void 0,!0),_:1}),(0,o.createVNode)(y,{id:"user_panel_notifications",title:"Notifications",description:"Toggle the notification subscriptions on each channel for this user.",tabindex:"-1"},{default:(0,o.withCtx)((function(){return[(0,o.createVNode)(P,{user:r.user,modelValue:r.form.subscriptions,"onUpdate:modelValue":t[4]||(t[4]=function(e){return r.form.subscriptions=e})},null,8,["user","modelValue"])]}),void 0,!0),_:1}),N.canEditPassword?((0,o.openBlock)(),(0,o.createBlock)(y,{key:0,id:"user_panel_security",title:"Security",description:"Configure this user's security details.",tabindex:"-1"},{default:(0,o.withCtx)((function(){return[(0,o.createVNode)(R,{help:r.user?"Only fill out the password fields below if you intend to update the user account password.":null},{default:(0,o.withCtx)((function(){return[(0,o.createVNode)(A,{id:"user-password",type:"password",name:"password",label:"Password",autocomplete:"new-password","has-error":r.form.errors.has("password"),"error-message":r.form.errors.get("password"),modelValue:r.form.password,"onUpdate:modelValue":t[5]||(t[5]=function(e){return r.form.password=e})},null,8,["has-error","error-message","modelValue"]),(0,o.createVNode)(A,{id:"user-password-confirm",type:"password",name:"password_confirmation",label:"Confirm Password",autocomplete:"new-password","has-error":r.form.errors.has("password_confirmation"),"error-message":r.form.errors.get("password_confirmation"),modelValue:r.form.password_confirmation,"onUpdate:modelValue":t[6]||(t[6]=function(e){return r.form.password_confirmation=e})},null,8,["has-error","error-message","modelValue"])]}),void 0,!0),_:1},8,["help"])]}),void 0,!0),_:1})):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(_,{to:"modals"},{default:(0,o.withCtx)((function(){return[(0,o.createVNode)($,{name:"verify-user",title:"Verification Email",key:"verify_user"},{footer:(0,o.withCtx)((function(){return[(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(k,{onClick:N.emailVerification,class:"ml-3",variant:"primary"},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Confirm")]}),void 0,!0),_:1},8,["onClick"])),[[q,void 0,"verify-user"]]),(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(k,{variant:"secondary"},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Cancel")]}),void 0,!0),_:1})),[[q,void 0,"verify-user"]])]})),default:(0,o.withCtx)((function(){return[w]}),void 0,!0),_:1}),(0,o.createVNode)($,{name:"password-user",title:"Password Reset",key:"password_user"},{footer:(0,o.withCtx)((function(){return[(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(k,{onClick:N.passwordReset,class:"ml-3",variant:"primary"},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Confirm")]}),void 0,!0),_:1},8,["onClick"])),[[q,void 0,"password-user"]]),(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(k,{variant:"secondary"},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Cancel")]}),void 0,!0),_:1})),[[q,void 0,"password-user"]])]})),default:(0,o.withCtx)((function(){return[V]}),void 0,!0),_:1}),(0,o.createVNode)($,{name:"expire-password",title:"Expire Password",key:"password_expire"},{footer:(0,o.withCtx)((function(e){return[(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(k,{onClick:N.passwordExpire,class:"ml-3",variant:"primary"},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Confirm")]}),void 0,!0),_:1},8,["onClick"])),[[q,void 0,"expire-password"]]),(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(k,{variant:"secondary"},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Cancel")]}),void 0,!0),_:1})),[[q,void 0,"expire-password"]])]})),default:(0,o.withCtx)((function(){return[x]}),void 0,!0),_:1}),(0,o.createVNode)($,{name:"delete-user",title:"Delete User",key:"delete_user"},{footer:(0,o.withCtx)((function(){return[(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(k,{onClick:N.destroy,variant:"danger",class:"ml-3"},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Delete")]}),void 0,!0),_:1},8,["onClick"])),[[q,void 0,"delete-user"]]),(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(k,{variant:"secondary"},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Cancel")]}),void 0,!0),_:1})),[[q,void 0,"delete-user"]])]})),default:(0,o.withCtx)((function(){return[C]}),void 0,!0),_:1})]}),void 0,!0),_:1})],512),[[o.vShow,!r.loading]])])}]])}}]);