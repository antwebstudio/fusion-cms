"use strict";(self.webpackChunkfusioncms=self.webpackChunkfusioncms||[]).push([[7934],{5320:(e,t,a)=>{a.d(t,{Z:()=>o});const o={methods:{downloadBackup:function(e){window.open("/backups/".concat(e),"_blank")},runBackup:function(){axios.post("/api/backups").then((function(e){return toast("Backup request added to queue!","success")})).catch((function(e){return toast(e.response.data.message,"failed")}))},destroyBackup:function(e){var t=this;axios.delete("/api/backups/".concat(e)).then((function(e){toast("Backp successfully deleted!","success"),t.$router.push("/backups")}))}}}},7934:(e,t,a)=>{a.r(t),a.d(t,{default:()=>q,getModel:()=>Z});var o=a(3802),n={class:"backups-page"},c={class:"buttons"},r={class:"detail-list"},l=(0,o.createElementVNode)("dt",null,"Disk",-1),s=(0,o.createElementVNode)("dt",null,"Size",-1),i=(0,o.createElementVNode)("dt",null,"Created",-1),d=(0,o.createElementVNode)("dt",null,"Status",-1),u={class:"flex"},p={key:0},m={key:1},k={key:2},f={class:"mb-4"},b=(0,o.createElementVNode)("span",{class:"label"},"Restore Backup",-1),V=(0,o.createElementVNode)("p",{class:"help mb-2"},"Restore FusionCMS to this backup.",-1),h={class:"mb-4"},N=(0,o.createElementVNode)("span",{class:"label"},"Download Backup",-1),v=(0,o.createElementVNode)("p",{class:"help mb-2"},"Download backup zip.",-1),g={class:"mb-4"},B=(0,o.createElementVNode)("span",{class:"label"},"Delete Backup",-1),E=(0,o.createElementVNode)("p",{class:"help mb-2"},"Once you delete this backup, there is no going back. Please be certain.",-1),x={key:0,class:"table","aria-live":"polite"},C=(0,o.createElementVNode)("tr",null,[(0,o.createElementVNode)("th",null,[(0,o.createElementVNode)("span",{class:"table__heading"},"Level")]),(0,o.createElementVNode)("th",null,[(0,o.createElementVNode)("span",{class:"table__heading"},"Message")]),(0,o.createElementVNode)("th",null,[(0,o.createElementVNode)("span",{class:"table__heading"},"Happened")])],-1),w={align:"center"},y=(0,o.createElementVNode)("span",{class:"column-label"},"Level",-1),_=(0,o.createElementVNode)("span",{class:"column-label"},"Message",-1),D={align:"center"},T=(0,o.createElementVNode)("span",{class:"column-label"},"Happened",-1),S=(0,o.createElementVNode)("p",null,"Are you sure you want to permenantly delete this backup?",-1);var M=a(8401);const L={permission:"backups.view",head:{title:function(){return{inner:this.backup.name||"Loading..."}}},mixins:[a(5320).Z,a(8273).Z],data:function(){return{backup:{},form:!1}},methods:{submit:function(){var e=this;this.form.patch("/api/backups/".concat(this.backup.id)).then((function(t){e.backup=t.data,toast("User successfully updated","success")})).catch((function(e){toast(e.response.data.message,"failed")}))}},beforeRouteEnter:function(e,t,a){Z(e.params.backup,(function(e,t){a(e?function(t){t.$router.push("/backup"),toast(e.toString(),"danger")}:function(e){e.backup=t,e.form=new M.Z({name:t.name},!0),window.emitter.emit("updateHead")})}))}};function Z(e,t){axios.get("/api/backups/".concat(e)).then((function(e){return t(null,e.data.data)})).catch((function(e){t(new Error("The requested role could not be found"))}))}const q=(0,a(3744).Z)(L,[["render",function(e,t,a,M,L,Z){var q=(0,o.resolveComponent)("page-title"),z=(0,o.resolveComponent)("portal"),R=(0,o.resolveComponent)("ui-button"),F=(0,o.resolveComponent)("ui-input-group"),H=(0,o.resolveComponent)("fa-icon"),$=(0,o.resolveComponent)("section-card"),A=(0,o.resolveComponent)("restore-backup-modal"),G=(0,o.resolveComponent)("ui-modal"),I=(0,o.resolveDirective)("modal");return(0,o.openBlock)(),(0,o.createElementBlock)("div",n,[(0,o.createVNode)(z,{to:"title"},{default:(0,o.withCtx)((function(){return[(0,o.createVNode)(q,{icon:"save"},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Backups - "+(0,o.toDisplayString)(L.backup.name),1)]}),void 0,!0),_:1})]}),void 0,!0),_:1}),(0,o.createVNode)(z,{to:"actions"},{default:(0,o.withCtx)((function(){return[(0,o.createElementVNode)("div",c,[(0,o.createVNode)(R,{key:"go-back-btn",to:{name:"backups"},variant:"secondary"},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Go Back")]}),void 0,!0),_:1}),(0,o.createVNode)(R,{key:"save-btn",variant:"primary",onClick:(0,o.withModifiers)(Z.submit,["prevent"]),disabled:!L.form.hasChanges},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Save")]}),void 0,!0),_:1},8,["onClick","disabled"])])]}),void 0,!0),_:1}),L.form?((0,o.openBlock)(),(0,o.createBlock)($,{key:0,title:"Backup Information",description:"General information about this backup."},{default:(0,o.withCtx)((function(){return[(0,o.createElementVNode)("dl",r,[(0,o.createVNode)(F,{id:"user-name",name:"name",label:"Name",autocomplete:"off",autofocus:"",required:"","has-error":L.form.errors.has("name"),"error-message":L.form.errors.get("name"),modelValue:L.form.name,"onUpdate:modelValue":t[0]||(t[0]=function(e){return L.form.name=e})},null,8,["has-error","error-message","modelValue"]),l,(0,o.createElementVNode)("dd",null,(0,o.toDisplayString)(L.backup.disk),1),s,(0,o.createElementVNode)("dd",null,[(0,o.createElementVNode)("code",null,(0,o.toDisplayString)(e.filesize(L.backup.size)),1)]),i,(0,o.createElementVNode)("dd",null,(0,o.toDisplayString)(e.$moment(L.backup.created_at).fromNow()),1),d,(0,o.createElementVNode)("dd",u,["success"==L.backup.state?((0,o.openBlock)(),(0,o.createElementBlock)("span",p,[(0,o.createVNode)(H,{icon:"circle",class:"icon fa-xs text-success-500"}),(0,o.createTextVNode)(" Success ")])):(0,o.createCommentVNode)("",!0),"failed"==L.backup.state?((0,o.openBlock)(),(0,o.createElementBlock)("span",m,[(0,o.createVNode)(H,{icon:"circle",class:"icon fa-xs text-danger-500"}),(0,o.createTextVNode)(" Failed ")])):(0,o.createCommentVNode)("",!0),"in-progress"==L.backup.state?((0,o.openBlock)(),(0,o.createElementBlock)("span",k,[(0,o.createVNode)(H,{icon:"circle",class:"icon fa-xs text-orange-500"}),(0,o.createTextVNode)(" In Progress ")])):(0,o.createCommentVNode)("",!0)])])]}),void 0,!0),_:1})):(0,o.createCommentVNode)("",!0),L.form?((0,o.openBlock)(),(0,o.createBlock)($,{key:1,title:"Actions",description:"Management actions that can be performed for this backup."},{default:(0,o.withCtx)((function(){return[(0,o.createElementVNode)("div",f,[b,V,(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(R,{variant:"secondary",onClick:t[1]||(t[1]=(0,o.withModifiers)((function(){}),["prevent"]))},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Restore Backup")]}),void 0,!0),_:1})),[[I,L.backup,"restore-backup"]])]),(0,o.createElementVNode)("div",h,[N,v,(0,o.createVNode)(R,{variant:"secondary",onClick:t[2]||(t[2]=(0,o.withModifiers)((function(t){return e.downloadBackup(L.backup.id)}),["prevent"]))},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Download Backup")]}),void 0,!0),_:1})]),(0,o.createElementVNode)("div",g,[B,E,(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(R,{variant:"danger"},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Delete Backup")]}),void 0,!0),_:1})),[[I,void 0,"delete-backup"]])])]}),void 0,!0),_:1})):(0,o.createCommentVNode)("",!0),(0,o.createVNode)($,{title:"Backup Log",description:"See what has been happening."},{default:(0,o.withCtx)((function(){return[L.backup.logs?((0,o.openBlock)(),(0,o.createElementBlock)("table",x,[C,((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(L.backup.logs.data,(function(e,t){return(0,o.openBlock)(),(0,o.createElementBlock)("tr",{key:"log-".concat(t)},[(0,o.createElementVNode)("td",w,[y,(0,o.createTextVNode)(" "+(0,o.toDisplayString)(e.level_name),1)]),(0,o.createElementVNode)("td",null,[_,(0,o.createTextVNode)(" "+(0,o.toDisplayString)(e.message),1)]),(0,o.createElementVNode)("td",D,[T,(0,o.createTextVNode)(" "+(0,o.toDisplayString)(e.happened),1)])])})),128))])):(0,o.createCommentVNode)("",!0)]}),void 0,!0),_:1}),(0,o.createVNode)(z,{to:"modals"},{default:(0,o.withCtx)((function(){return[(0,o.createVNode)(A),(0,o.createVNode)(G,{name:"delete-backup",title:"Delete Backup",key:"delete_backup"},{footer:(0,o.withCtx)((function(){return[(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(R,{onClick:t[3]||(t[3]=function(t){return e.destroyBackup(L.backup.id)}),variant:"danger",class:"ml-3"},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Delete")]}),void 0,!0),_:1})),[[I,void 0,"delete-backup"]]),(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(R,null,{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Cancel")]}),void 0,!0),_:1})),[[I,void 0,"delete-backup"]])]})),default:(0,o.withCtx)((function(){return[S]}),void 0,!0),_:1})]}),void 0,!0),_:1})])}]])}}]);