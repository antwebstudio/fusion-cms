"use strict";(self.webpackChunkfusioncms=self.webpackChunkfusioncms||[]).push([[9402],{5320:(e,t,o)=>{o.d(t,{Z:()=>n});const n={methods:{downloadBackup:function(e){window.open("/backups/".concat(e),"_blank")},runBackup:function(){axios.post("/api/backups").then((function(e){return toast("Backup request added to queue!","success")})).catch((function(e){return toast(e.response.data.message,"failed")}))},destroyBackup:function(e){var t=this;axios.delete("/api/backups/".concat(e)).then((function(e){toast("Backp successfully deleted!","success"),t.$router.push("/backups")}))}}}},9402:(e,t,o)=>{o.r(t),o.d(t,{default:()=>d});var n=o(3802),c={class:"backups-page"},a={class:"buttons"},r=(0,n.createElementVNode)("p",null,"This will perform a full backup of your website. Backups can take up to one minute per GB of data.",-1),i=(0,n.createElementVNode)("p",null,"Are you sure you want to permenantly delete this backup?",-1);const u={head:{title:function(){return{inner:"Backups"}}},mixins:[o(5320).Z,o(8273).Z],data:function(){return{endpoint:"/datatable/backups"}},methods:{upload:function(e){var t=this;if(void 0!==e){var o=new FormData;o.append("_method","POST"),o.append("file-upload",e),axios.post("/api/backups/upload",o).then((function(){toast("Backup successfully uploaded!","success"),t.$refs.upload.remove(),bus().$emit("refresh-datatable-backups")}))}}}};const d=(0,o(3744).Z)(u,[["render",function(e,t,o,u,d,l){var s=(0,n.resolveComponent)("page-title"),p=(0,n.resolveComponent)("portal"),k=(0,n.resolveComponent)("ui-button"),f=(0,n.resolveComponent)("ui-status"),v=(0,n.resolveComponent)("router-link"),m=(0,n.resolveComponent)("ui-dropdown-link"),h=(0,n.resolveComponent)("ui-dropdown-divider"),w=(0,n.resolveComponent)("ui-actions"),C=(0,n.resolveComponent)("ui-table"),b=(0,n.resolveComponent)("ui-card-body"),x=(0,n.resolveComponent)("ui-card"),B=(0,n.resolveComponent)("restore-backup-modal"),N=(0,n.resolveComponent)("ui-modal"),V=(0,n.resolveComponent)("ui-upload"),_=(0,n.resolveDirective)("modal");return(0,n.openBlock)(),(0,n.createElementBlock)("div",c,[(0,n.createVNode)(p,{to:"title"},{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(s,{icon:"save"},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)("Backups")]}),void 0,!0),_:1})]}),void 0,!0),_:1}),(0,n.createVNode)(p,{to:"actions"},{default:(0,n.withCtx)((function(){return[(0,n.createElementVNode)("div",a,[(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createBlock)(k,{class:"mr-1"},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)("Upload")]}),void 0,!0),_:1})),[[_,void 0,"upload-backup"]]),(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createBlock)(k,{onClick:t[0]||(t[0]=(0,n.withModifiers)((function(){}),["prevent"])),variant:"primary"},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)("Backup Now")]}),void 0,!0),_:1})),[[_,void 0,"confirm-backup"]])])]}),void 0,!0),_:1}),(0,n.createVNode)(x,null,{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(b,null,{default:(0,n.withCtx)((function(){return[((0,n.openBlock)(),(0,n.createBlock)(C,{refresh:5e3,key:"backups",class:"backup-table",id:"backups",endpoint:d.endpoint,"sort-by":"name","sort-in":"desc","per-page":50},{name:(0,n.withCtx)((function(e){return[(0,n.createVNode)(f,{value:"success"==e.record.state,class:"mr-2"},null,8,["value"]),(0,n.createVNode)(v,{to:{name:"backups.show",params:{backup:e.record.id}}},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)((0,n.toDisplayString)(e.record.name),1)]}),void 0,!0),_:2},1032,["to"])]})),size:(0,n.withCtx)((function(t){return[(0,n.createElementVNode)("code",null,(0,n.toDisplayString)(e.filesize(t.record.size)),1)]})),created_at:(0,n.withCtx)((function(t){return[(0,n.createTextVNode)((0,n.toDisplayString)(e.$moment(t.record.created_at).fromNow()),1)]})),actions:(0,n.withCtx)((function(o){return[((0,n.openBlock)(),(0,n.createBlock)(w,{id:"backup_"+o.record.id+"_actions",key:"backup_"+o.record.id+"_actions"},{default:(0,n.withCtx)((function(){return[e.$can("backups.view")?((0,n.openBlock)(),(0,n.createBlock)(m,{key:0,to:{name:"backups.show",params:{backup:o.record.id}}},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)(" View ")]}),void 0,!0),_:2},1032,["to"])):(0,n.createCommentVNode)("",!0),(0,n.createVNode)(h),e.$can("backups.restore")?(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createBlock)(m,{key:1,onClick:t[1]||(t[1]=(0,n.withModifiers)((function(){}),["prevent"]))},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)(" Restore ")]}),void 0,!0),_:2},1024)),[[_,o.record,"restore-backup"]]):(0,n.createCommentVNode)("",!0),(0,n.createVNode)(m,{onClick:(0,n.withModifiers)((function(t){return e.downloadBackup(o.record.id)}),["prevent"])},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)(" Download ")]}),void 0,!0),_:2},1032,["onClick"]),!o.record.isLatest&&e.$can("backups.delete")?(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createBlock)(m,{key:2,onClick:t[2]||(t[2]=(0,n.withModifiers)((function(){}),["prevent"]))},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)(" Delete ")]}),void 0,!0),_:2},1024)),[[_,o.record,"delete-backup"]]):(0,n.createCommentVNode)("",!0)]}),void 0,!0),_:2},1032,["id"]))]})),_:1},8,["endpoint"]))]}),void 0,!0),_:1})]}),void 0,!0),_:1}),(0,n.createVNode)(p,{to:"modals"},{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(B),(0,n.createVNode)(N,{name:"confirm-backup",title:"Backup Now",key:"confirm_backup"},{footer:(0,n.withCtx)((function(){return[(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createBlock)(k,{onClick:t[3]||(t[3]=function(t){return e.runBackup()}),variant:"primary",class:"ml-3"},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)("Backup")]}),void 0,!0),_:1})),[[_,void 0,"confirm-backup"]]),(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createBlock)(k,null,{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)("Cancel")]}),void 0,!0),_:1})),[[_,void 0,"confirm-backup"]])]})),default:(0,n.withCtx)((function(){return[r]}),void 0,!0),_:1}),(0,n.createVNode)(N,{name:"delete-backup",title:"Delete Backup",key:"delete_backup"},{footer:(0,n.withCtx)((function(t){return[(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createBlock)(k,{onClick:function(o){return e.destroyBackup(t.data.id)},variant:"danger",class:"ml-3"},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)("Delete")]}),void 0,!0),_:2},1032,["onClick"])),[[_,void 0,"delete-backup"]]),(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createBlock)(k,null,{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)("Cancel")]}),void 0,!0),_:1})),[[_,void 0,"delete-backup"]])]})),default:(0,n.withCtx)((function(){return[i]}),void 0,!0),_:1}),(0,n.createVNode)(N,{name:"upload-backup",title:"Upload Backup",key:"upload_backup"},{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(V,{name:"file-upload",label:"Upload",ref:"upload",accept:"zip",multiple:!1,onInput:l.upload},null,8,["onInput"])]}),void 0,!0),_:1})]}),void 0,!0),_:1})])}]])}}]);