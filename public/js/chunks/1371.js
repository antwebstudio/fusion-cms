"use strict";(self.webpackChunkfusioncms=self.webpackChunkfusioncms||[]).push([[1371],{1371:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b,getSingle:()=>y});var o=n(3802),r={class:"single-page"};var l=n(8401),a={class:"buttons"},i={key:0,class:"entry-slug"},s={key:0,class:"entry-slug__current"},u=(0,o.createElementVNode)("span",{class:"entry-slug__label"},"Slug:",-1),d={class:"entry-slug__value"},c={key:1,class:"entry-slug__edit"},m={key:0,class:"entry-slug__label",for:"edit-slug"};const f={props:{entry:{required:!0},single:{required:!0},form:{type:Object,required:!0}},data:function(){return{editSlug:!1,slugValue:""}},computed:{sections:function(){return{body:_.filter(this.single.blueprint.sections,(function(e){return"body"==e.placement})),sidebar:_.filter(this.single.blueprint.sections,(function(e){return"sidebar"==e.placement}))}}},methods:{openEdit:function(){this.slugValue=this.form.slug,this.editSlug=!0,this.slugFocus()},closeEdit:function(){this.slugValue="",this.editSlug=!1,this.editBtnFocus()},saveSlug:function(){""===this.slugValue?this.slugValue=this.form.slug:this.form.slug=this.slugValue,this.closeEdit()},slugFocus:function(){var e=this;this.$nextTick((function(){e.$refs.slug.$el.focus()}))},editBtnFocus:function(){var e=this;this.$nextTick((function(){e.$refs.edit.$el.focus()}))}}};var p=n(3744);const g=(0,p.Z)(f,[["render",function(e,t,n,r,l,f){var p=(0,o.resolveComponent)("ui-button"),g=(0,o.resolveComponent)("portal"),h=(0,o.resolveComponent)("ui-toggle"),_=(0,o.resolveComponent)("ui-flatpickr-group"),V=(0,o.resolveComponent)("sidebar-section"),k=(0,o.resolveComponent)("status-card"),y=(0,o.resolveComponent)("sidebar"),b=(0,o.resolveComponent)("ui-title-group"),v=(0,o.resolveComponent)("ui-slug"),C=(0,o.resolveComponent)("ui-card-body"),x=(0,o.resolveComponent)("ui-card"),B=(0,o.resolveComponent)("section-card");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createVNode)(g,{to:"actions"},{default:(0,o.withCtx)((function(){return[(0,o.createElementVNode)("div",a,["sm"!=e.$mq&&n.single.slug?((0,o.openBlock)(),(0,o.createBlock)(p,{key:0,to:{name:"single.index",params:{single:n.single.slug}},variant:"secondary"},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Go Back")]}),void 0,!0),_:1},8,["to"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(p,{type:"submit",onClick:(0,o.withModifiers)(e.$parent.submit,["prevent"]),variant:"primary",disabled:!n.form.hasChanges},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Save")]}),void 0,!0),_:1},8,["onClick","disabled"])])]}),void 0,!0),_:1}),(0,o.createVNode)(g,{to:"sidebar-right"},{default:(0,o.withCtx)((function(){return[n.single?((0,o.openBlock)(),(0,o.createBlock)(y,{key:0,id:"single-sidebar"},{default:(0,o.withCtx)((function(){return[(0,o.createVNode)(V,{id:"single_panel_status",tabindex:"-1"},{default:(0,o.withCtx)((function(){return[(0,o.createVNode)(h,{name:"status",label:"Status",help:n.form.status?"Toggle to disable this entry.":"Toggle to enable this entry.",modelValue:n.form.status,"onUpdate:modelValue":t[0]||(t[0]=function(e){return n.form.status=e}),"true-value":1,"false-value":0},null,8,["help","modelValue"]),(0,o.createVNode)(_,{modelValue:n.form.publish_at,"onUpdate:modelValue":t[1]||(t[1]=function(e){return n.form.publish_at=e}),name:"publish_at",id:"publish_at",label:"Publish Date","with-time":!0,"has-error":n.form.errors.has("publish_at"),"error-message":n.form.errors.get("publish_at")},null,8,["modelValue","has-error","error-message"]),(0,o.createVNode)(_,{modelValue:n.form.expire_at,"onUpdate:modelValue":t[2]||(t[2]=function(e){return n.form.expire_at=e}),name:"expire_at",id:"expire_at",label:"Expiry Date","with-time":!0,"has-error":n.form.errors.has("expire_at"),"error-message":n.form.errors.get("expire_at")},null,8,["modelValue","has-error","error-message"])]}),void 0,!0),_:1}),e.section.fields.length>0?((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,{key:0},(0,o.renderList)(f.sections.sidebar,(function(e){return(0,o.openBlock)(),(0,o.createBlock)(V,{key:e.handle,id:"single_panel_"+e.handle,title:e.name,description:e.description,tabindex:"-1"},{default:(0,o.withCtx)((function(){return[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(e.fields,(function(e){return(0,o.openBlock)(),(0,o.createBlock)((0,o.resolveDynamicComponent)(e.type.id+"-fieldtype"),{key:e.handle,field:e,"has-error":n.form.errors.has(e.handle),"error-message":n.form.errors.get(e.handle),modelValue:n.form[e.handle],"onUpdate:modelValue":function(t){return n.form[e.handle]=t}},null,8,["field","has-error","error-message","modelValue","onUpdate:modelValue"])})),128))]}),void 0,!0),_:2},1032,["id","title","description"])})),128)):(0,o.createCommentVNode)("",!0),n.entry?((0,o.openBlock)(),(0,o.createBlock)(k,{key:1,entry:n.entry,id:"single_panel_status_card",tabindex:"-1"},null,8,["entry"])):(0,o.createCommentVNode)("",!0)]}),void 0,!0),_:1})):(0,o.createCommentVNode)("",!0)]}),void 0,!0),_:1}),n.single.show_name_field?((0,o.openBlock)(),(0,o.createBlock)(x,{key:0,id:"single_panel_"+n.single.handle,tabindex:"-1"},{default:(0,o.withCtx)((function(){return[(0,o.createVNode)(C,null,{default:(0,o.withCtx)((function(){return[(0,o.createVNode)(b,{class:"mb-0",name:"name",label:n.single.name_label||"Name",autocomplete:"off",autofocus:"",required:"",readonly:l.editSlug,placeholder:n.single.name_label||"Name","has-error":n.form.errors.has("name"),"error-message":n.form.errors.get("name"),modelValue:n.form.name,"onUpdate:modelValue":t[3]||(t[3]=function(e){return n.form.name=e})},null,8,["label","readonly","placeholder","has-error","error-message","modelValue"]),n.form.slug?((0,o.openBlock)(),(0,o.createElementBlock)("div",i,[l.editSlug?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("div",s,[u,(0,o.createElementVNode)("span",d,(0,o.toDisplayString)(n.form.slug),1),(0,o.createVNode)(p,{ref:"edit",class:"entry-slug__action",size:"xsmall",onClick:t[4]||(t[4]=(0,o.withModifiers)((function(e){return f.openEdit()}),["prevent"]))},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Edit")]}),void 0,!0),_:1},512)])),l.editSlug?((0,o.openBlock)(),(0,o.createElementBlock)("div",c,[l.editSlug?((0,o.openBlock)(),(0,o.createElementBlock)("label",m,"Slug:")):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(v,{ref:"slug",class:"field--xs",id:"edit-slug",name:"edit_slug",monospaced:"",autocomplete:"off",modelValue:l.slugValue,"onUpdate:modelValue":t[5]||(t[5]=function(e){return l.slugValue=e})},null,8,["modelValue"]),(0,o.createVNode)(p,{class:"entry-slug__action",variant:"primary",size:"xsmall",onClick:t[6]||(t[6]=(0,o.withModifiers)((function(e){return f.saveSlug()}),["prevent"]))},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Apply")]}),void 0,!0),_:1}),(0,o.createVNode)(p,{class:"entry-slug__action",variant:"secondary",size:"xsmall",onClick:t[7]||(t[7]=(0,o.withModifiers)((function(e){return f.closeEdit()}),["prevent"]))},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Cancel")]}),void 0,!0),_:1})])):(0,o.createCommentVNode)("",!0)])):(0,o.createCommentVNode)("",!0),n.entry.id?((0,o.openBlock)(),(0,o.createBlock)(v,{key:1,type:"hidden",name:"slug",label:"Slug",monospaced:"",autocomplete:"off",required:"",help:n.single.show_name_field?"":"This field is auto-generated based on pattern specified.",watch:n.form.name,readonly:!n.single.show_name_field,"has-error":n.form.errors.has("slug"),"error-message":n.form.errors.get("slug"),modelValue:n.form.slug,"onUpdate:modelValue":t[8]||(t[8]=function(e){return n.form.slug=e})},null,8,["help","watch","readonly","has-error","error-message","modelValue"])):(0,o.createCommentVNode)("",!0)]}),void 0,!0),_:1})]}),void 0,!0),_:1},8,["id"])):(0,o.createCommentVNode)("",!0),e.section.fields.length>0?((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,{key:1},(0,o.renderList)(f.sections.body,(function(e){return(0,o.openBlock)(),(0,o.createBlock)(B,{key:e.handle,id:"single_panel_"+e.handle,title:e.name,description:e.description,tabindex:"-1"},{default:(0,o.withCtx)((function(){return[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(e.fields,(function(e){return(0,o.openBlock)(),(0,o.createBlock)((0,o.resolveDynamicComponent)(e.type.id+"-fieldtype"),{key:e.handle,field:e,errors:n.form.errors,modelValue:n.form[e.handle],"onUpdate:modelValue":function(t){return n.form[e.handle]=t}},null,8,["field","errors","modelValue","onUpdate:modelValue"])})),128))]}),void 0,!0),_:2},1032,["id","title","description"])})),128)):(0,o.createCommentVNode)("",!0)])}]]);var h=n(6486),V=n.n(h);const k={head:{title:function(){return{inner:V().has(this.form,"name")?this.form.name:"Loading..."}}},data:function(){return{single:{},entry:{},form:null}},components:{"shared-form":g},computed:{sections:function(){return{body:V().filter(this.single.blueprint.sections,(function(e){return"body"==e.placement})),sidebar:V().filter(this.single.blueprint.sections,(function(e){return"sidebar"==e.placement}))}}},methods:{submit:function(){var e=this;this.form.patch("/api/singles/"+this.single.id).then((function(t){toast("Single saved successfully","success"),e.$router.go()})).catch((function(e){toast(e.message,"failed")}))}},beforeRouteEnter:function(e,t,n){y(e.params.single,(function(e,t,o,r){n((function(e){e.single=o,e.entry=t,e.form=new l.Z(r,!0),window.emitter.emit("updateHead")}))}))},beforeRouteUpdate:function(e,t,n){var o=this;y(e.params.single,(function(e,t,n,r){o.single=n,o.entry=t,o.form=new l.Z(r,!0),o.$emit("updateHead")})),n()}};function y(e,t){axios.get("/api/singles/"+e).then((function(e){var n={},o={};V().has(e,"data.data.single")?(o=e.data.data.matrix,n=e.data.data.single):(o=e.data.data,n={name:o.name,slug:o.slug,publish_at:null,expire_at:null,status:1});var r={name:n.name,slug:n.slug,publish_at:n.publish_at,expire_at:n.expire_at,status:n.status};V().forEach(o.blueprint.sections,(function(e){V().forEach(e.fields,(function(e){r[e.handle]=n[e.handle]}))})),t(null,n,o,r)})).catch((function(e){t(new Error("The requested entry could not be found"))}))}const b=(0,p.Z)(k,[["render",function(e,t,n,l,a,i){var s=(0,o.resolveComponent)("page-title"),u=(0,o.resolveComponent)("portal"),d=(0,o.resolveComponent)("shared-form");return(0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createVNode)(u,{to:"title"},{default:(0,o.withCtx)((function(){return[(0,o.createVNode)(s,{icon:a.single.icon||"pencil-alt",subtitle:a.single.description},{default:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Edit")]}),void 0,!0),_:1},8,["icon","subtitle"])]}),void 0,!0),_:1}),a.form?((0,o.openBlock)(),(0,o.createBlock)(d,{key:0,form:a.form,entry:a.entry,single:a.single},null,8,["form","entry","single"])):(0,o.createCommentVNode)("",!0)])}]])}}]);