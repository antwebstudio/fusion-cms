"use strict";(self.webpackChunkfusioncms=self.webpackChunkfusioncms||[]).push([[5734],{1381:(e,t,o)=>{o.d(t,{Z:()=>r});const r={methods:{isAssignable:function(e,t){return!_.includes(["guest"],e)&&this.$level(t)},isRemovable:function(e,t){return!_.includes(["owner","user","guest"],e)&&this.$level(t)},hasPermissions:function(e){return!_.includes(["owner"],e)}}}},5734:(e,t,o)=>{o.r(t),o.d(t,{default:()=>l,getRoles:()=>i});var r=o(3802),s={class:"user-page"};var n=o(8401);const a={auth:function(){return{permission:"users.create"}},head:{title:function(){return{inner:"Create a User"}}},data:function(){return{roles:[],form:new n.Z({name:"",email:"",role:"user",password:"",password_confirmation:"",email_verified_at:this.$moment().format("X"),subscriptions:[],status:1},!0),loading:!1}},components:{"shared-form":o(6469).Z},methods:{submit:function(){var e=this;this.loading=!0,this.form.post("/api/users").then((function(t){toast("User successfully created","success"),e.$router.push("/users")})).catch((function(t){toast(t.message,"failed"),e.loading=!1}))}},beforeRouteEnter:function(e,t,o){i((function(e,t){o(e?function(t){t.$router.push("/users"),toast(e.toString(),"danger")}:function(e){e.roles=t,e.$emit("updateHead")})}))}};function i(e){axios.get("/api/roles").then((function(t){e(null,t.data.data)})).catch((function(t){e(new Error("Roles could not be found"))}))}const l=(0,o(3744).Z)(a,[["render",function(e,t,o,n,a,i){var l=(0,r.resolveComponent)("page-title"),u=(0,r.resolveComponent)("portal"),c=(0,r.resolveComponent)("shared-form");return(0,r.openBlock)(),(0,r.createElementBlock)("div",s,[(0,r.createVNode)(u,{to:"title"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(l,{icon:"user-alt"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Create User")]}),void 0,!0),_:1})]}),void 0,!0),_:1}),(0,r.createVNode)(c,{loading:a.loading,form:a.form,roles:a.roles,submit:i.submit},null,8,["loading","form","roles","submit"])])}]])},6469:(e,t,o)=>{o.d(t,{Z:()=>g});var r=o(3802),s={class:"buttons"},n={class:"mb-4"},a=(0,r.createElementVNode)("span",{class:"label"},"Verification Email",-1),i=(0,r.createElementVNode)("p",{class:"help mb-2"},"Re-send the verification email to this user.",-1),l={class:"mb-4"},u=(0,r.createElementVNode)("span",{class:"label"},"Password Reset",-1),c=(0,r.createElementVNode)("p",{class:"help mb-2"},"Re-send password reset email to this user.",-1),d={class:"mb-4"},m=(0,r.createElementVNode)("span",{class:"label"},"Expire Password",-1),f=(0,r.createElementVNode)("p",{class:"help mb-2"},"Force the user to reset their password upon next login attempt.",-1),p={class:"mb-4"},h=(0,r.createElementVNode)("span",{class:"label"},"Delete User",-1),v=(0,r.createElementVNode)("p",{class:"help mb-2"},"Once you delete this user, there is no going back. Please be certain.",-1),w=(0,r.createElementVNode)("p",null,"Are you sure you want to re-send the verification email to this user?",-1),V=(0,r.createElementVNode)("p",null,"Are you sure you want to send this user a password reset notification?",-1),C=(0,r.createElementVNode)("p",null,"Are you sure you want to force user to reset their password upon next login?",-1),x=(0,r.createElementVNode)("p",null,"Are you sure you want to permenantly delete this user?",-1);const b={mixins:[o(1381).Z],props:{form:{type:Object,required:!0},submit:{required:!0},roles:{type:Array,required:!0},user:{type:Object,required:!1},loading:{type:Boolean,required:!1}},computed:{roleOptions:function(){var e=this,t=_.filter(this.roles,(function(t){return e.isAssignable(t.name,t.level)}));return _.map(t,(function(e){return{label:e.name,value:e.handle}}))},canEditPassword:function(){return this.user&&this.$store.state.auth.user&&this.user.id==this.$store.state.auth.user.id}},methods:{destroy:function(){var e=this;axios.delete("/api/users/".concat(this.user.id)).then((function(t){toast("User successfully removed from system.","success"),e.$router.push("/users")})).catch((function(e){toast(e.response.data.message,"failed")}))},emailVerification:function(){axios.post("/api/users/".concat(this.user.id,"/verify")).then((function(e){toast("Email verification notification has been sent to user.","success")})).catch((function(e){toast(e.response.data.message,"failed")}))},passwordReset:function(){axios.post("/api/users/".concat(this.user.id,"/reset-password")).then((function(e){toast("Password reset notification has been sent to user.","success")})).catch((function(e){toast(e.response.data.message,"failed")}))},passwordExpire:function(){axios.post("/api/users/".concat(this.user.id,"/expire-password")).then((function(e){toast("User password has been set as expired.","success")})).catch((function(e){toast(e.response.data.message,"failed")}))}}};const g=(0,o(3744).Z)(b,[["render",function(e,t,o,b,g,N){var k=(0,r.resolveComponent)("ui-button"),_=(0,r.resolveComponent)("portal"),y=(0,r.resolveComponent)("section-card"),B=(0,r.resolveComponent)("ui-toggle"),E=(0,r.resolveComponent)("sidebar-section"),D=(0,r.resolveComponent)("sidebar"),T=(0,r.resolveComponent)("ui-input-group"),U=(0,r.resolveComponent)("ui-select-group"),P=(0,r.resolveComponent)("user-notifications"),R=(0,r.resolveComponent)("ui-password-group"),$=(0,r.resolveComponent)("ui-fieldset"),q=(0,r.resolveComponent)("ui-modal"),S=(0,r.resolveDirective)("modal");return(0,r.openBlock)(),(0,r.createElementBlock)("div",null,[(0,r.createVNode)(_,{to:"actions"},{default:(0,r.withCtx)((function(){return[(0,r.createElementVNode)("div",s,["sm"!=e.$mq?((0,r.openBlock)(),(0,r.createBlock)(k,{key:"go-back-btn",to:{name:"users"},variant:"secondary"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Go Back")]}),void 0,!0),_:1})):(0,r.createCommentVNode)("",!0),(0,r.createVNode)(k,{key:"save-btn",variant:"primary",onClick:(0,r.withModifiers)(o.submit,["prevent"]),disabled:!o.form.hasChanges||o.loading},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Save")]}),void 0,!0),_:1},8,["onClick","disabled"])])]}),void 0,!0),_:1}),(0,r.withDirectives)((0,r.createVNode)(y,{title:"Loading..."},null,512),[[r.vShow,o.loading]]),(0,r.createVNode)(_,{to:"sidebar-right"},{default:(0,r.withCtx)((function(){return[(0,r.withDirectives)((0,r.createElementVNode)("div",null,[(0,r.createVNode)(D,{id:"users-sidebar"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(E,{id:"users_panel_status",tabindex:"-1"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(B,{id:"user-status",name:"status",label:"Status",help:o.form.status?"Toggle to disable this user.":"Toggle to enable this user.",modelValue:o.form.status,"onUpdate:modelValue":t[0]||(t[0]=function(e){return o.form.status=e}),"true-value":1,"false-value":0},null,8,["help","modelValue"])]}),void 0,!0),_:1}),o.user?((0,r.openBlock)(),(0,r.createBlock)(E,{key:0,title:"Actions",description:"Management actions that can be performed for this user.",tabindex:"-1"},{default:(0,r.withCtx)((function(){return[(0,r.createElementVNode)("div",n,[a,i,(0,r.withDirectives)(((0,r.openBlock)(),(0,r.createBlock)(k,{size:"small",variant:"secondary"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Send Verification")]}),void 0,!0),_:1})),[[S,void 0,"verify-user"]])]),(0,r.createElementVNode)("div",l,[u,c,(0,r.withDirectives)(((0,r.openBlock)(),(0,r.createBlock)(k,{size:"small",variant:"secondary"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Reset Password")]}),void 0,!0),_:1})),[[S,void 0,"password-user"]])]),(0,r.createElementVNode)("div",d,[m,f,(0,r.withDirectives)(((0,r.openBlock)(),(0,r.createBlock)(k,{size:"small",variant:"secondary"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Expire Password")]}),void 0,!0),_:1})),[[S,void 0,"expire-password"]])]),(0,r.createElementVNode)("div",p,[h,v,(0,r.withDirectives)(((0,r.openBlock)(),(0,r.createBlock)(k,{size:"small",variant:"danger"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Delete User")]}),void 0,!0),_:1})),[[S,void 0,"delete-user"]])])]}),void 0,!0),_:1})):(0,r.createCommentVNode)("",!0)]}),void 0,!0),_:1})],512),[[r.vShow,!o.loading]])]}),void 0,!0),_:1}),(0,r.withDirectives)((0,r.createElementVNode)("div",null,[(0,r.createVNode)(y,{id:"user_panel_general",title:"General Information",description:"General information about this user.",tabindex:"-1"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(T,{id:"user-name",name:"name",label:"Name",autocomplete:"off",autofocus:"",required:"","has-error":o.form.errors.has("name"),"error-message":o.form.errors.get("name"),modelValue:o.form.name,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.form.name=e})},null,8,["has-error","error-message","modelValue"]),(0,r.createVNode)(T,{id:"user-id",type:"email",name:"email",label:"E-mail",autocomplete:"off","has-error":o.form.errors.has("email"),"error-message":o.form.errors.get("email"),required:"",modelValue:o.form.email,"onUpdate:modelValue":t[2]||(t[2]=function(e){return o.form.email=e})},null,8,["has-error","error-message","modelValue"])]}),void 0,!0),_:1}),(0,r.createVNode)(y,{id:"user_panel_permissions",title:"Permissions",description:"Select the role to determine which areas of the website this user can access.",tabindex:"-1"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(U,{id:"user-role",name:"role",label:"Role",options:N.roleOptions,autocomplete:"off","has-error":o.form.errors.has("role"),"error-message":o.form.errors.get("role"),required:"",modelValue:o.form.role,"onUpdate:modelValue":t[3]||(t[3]=function(e){return o.form.role=e})},null,8,["options","has-error","error-message","modelValue"])]}),void 0,!0),_:1}),(0,r.createVNode)(y,{id:"user_panel_notifications",title:"Notifications",description:"Toggle the notification subscriptions on each channel for this user.",tabindex:"-1"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(P,{user:o.user,modelValue:o.form.subscriptions,"onUpdate:modelValue":t[4]||(t[4]=function(e){return o.form.subscriptions=e})},null,8,["user","modelValue"])]}),void 0,!0),_:1}),N.canEditPassword?((0,r.openBlock)(),(0,r.createBlock)(y,{key:0,id:"user_panel_security",title:"Security",description:"Configure this user's security details.",tabindex:"-1"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)($,{help:o.user?"Only fill out the password fields below if you intend to update the user account password.":null},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(R,{id:"user-password",type:"password",name:"password",label:"Password",autocomplete:"new-password","has-error":o.form.errors.has("password"),"error-message":o.form.errors.get("password"),modelValue:o.form.password,"onUpdate:modelValue":t[5]||(t[5]=function(e){return o.form.password=e})},null,8,["has-error","error-message","modelValue"]),(0,r.createVNode)(R,{id:"user-password-confirm",type:"password",name:"password_confirmation",label:"Confirm Password",autocomplete:"new-password","has-error":o.form.errors.has("password_confirmation"),"error-message":o.form.errors.get("password_confirmation"),modelValue:o.form.password_confirmation,"onUpdate:modelValue":t[6]||(t[6]=function(e){return o.form.password_confirmation=e})},null,8,["has-error","error-message","modelValue"])]}),void 0,!0),_:1},8,["help"])]}),void 0,!0),_:1})):(0,r.createCommentVNode)("",!0),(0,r.createVNode)(_,{to:"modals"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(q,{name:"verify-user",title:"Verification Email",key:"verify_user"},{footer:(0,r.withCtx)((function(){return[(0,r.withDirectives)(((0,r.openBlock)(),(0,r.createBlock)(k,{onClick:N.emailVerification,class:"ml-3",variant:"primary"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Confirm")]}),void 0,!0),_:1},8,["onClick"])),[[S,void 0,"verify-user"]]),(0,r.withDirectives)(((0,r.openBlock)(),(0,r.createBlock)(k,{variant:"secondary"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Cancel")]}),void 0,!0),_:1})),[[S,void 0,"verify-user"]])]})),default:(0,r.withCtx)((function(){return[w]}),void 0,!0),_:1}),(0,r.createVNode)(q,{name:"password-user",title:"Password Reset",key:"password_user"},{footer:(0,r.withCtx)((function(){return[(0,r.withDirectives)(((0,r.openBlock)(),(0,r.createBlock)(k,{onClick:N.passwordReset,class:"ml-3",variant:"primary"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Confirm")]}),void 0,!0),_:1},8,["onClick"])),[[S,void 0,"password-user"]]),(0,r.withDirectives)(((0,r.openBlock)(),(0,r.createBlock)(k,{variant:"secondary"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Cancel")]}),void 0,!0),_:1})),[[S,void 0,"password-user"]])]})),default:(0,r.withCtx)((function(){return[V]}),void 0,!0),_:1}),(0,r.createVNode)(q,{name:"expire-password",title:"Expire Password",key:"password_expire"},{footer:(0,r.withCtx)((function(e){return[(0,r.withDirectives)(((0,r.openBlock)(),(0,r.createBlock)(k,{onClick:N.passwordExpire,class:"ml-3",variant:"primary"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Confirm")]}),void 0,!0),_:1},8,["onClick"])),[[S,void 0,"expire-password"]]),(0,r.withDirectives)(((0,r.openBlock)(),(0,r.createBlock)(k,{variant:"secondary"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Cancel")]}),void 0,!0),_:1})),[[S,void 0,"expire-password"]])]})),default:(0,r.withCtx)((function(){return[C]}),void 0,!0),_:1}),(0,r.createVNode)(q,{name:"delete-user",title:"Delete User",key:"delete_user"},{footer:(0,r.withCtx)((function(){return[(0,r.withDirectives)(((0,r.openBlock)(),(0,r.createBlock)(k,{onClick:N.destroy,variant:"danger",class:"ml-3"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Delete")]}),void 0,!0),_:1},8,["onClick"])),[[S,void 0,"delete-user"]]),(0,r.withDirectives)(((0,r.openBlock)(),(0,r.createBlock)(k,{variant:"secondary"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Cancel")]}),void 0,!0),_:1})),[[S,void 0,"delete-user"]])]})),default:(0,r.withCtx)((function(){return[x]}),void 0,!0),_:1})]}),void 0,!0),_:1})],512),[[r.vShow,!o.loading]])])}]])}}]);