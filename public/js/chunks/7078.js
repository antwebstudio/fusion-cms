"use strict";(self.webpackChunkfusioncms=self.webpackChunkfusioncms||[]).push([[7078],{7078:(e,t,o)=>{o.r(t),o.d(t,{default:()=>c,getEntry:()=>i});var n=o(3802),l={class:"collection-page"};var r=o(8401);const a={head:{title:function(){return{inner:_.has(this.form,"name")?this.form.name:"Loading..."}}},data:function(){return{collection:{},entry:{},form:null,loading:!1}},components:{"shared-form":o(1690).Z},methods:{submit:function(){var e=this;this.loading=!0,this.form.patch("/api/collections/"+this.collection.slug+"/"+this.entry.id).then((function(t){toast("Entry saved successfully","success"),e.$router.push("/collection/"+e.collection.slug)})).catch((function(t){toast(t.message,"failed"),e.loading=!1}))}},beforeRouteEnter:function(e,t,o){i(e.params.collection,e.params.id,(function(e,t,n,l){o(e?function(t){t.$router.push("/collection/"+t.$router.currentRoute.params.collection),toast(e.toString(),"danger")}:function(e){e.collection=n,e.entry=t,e.form=new r.Z(l,!0),window.emitter.emit("updateHead")})}))},beforeRouteUpdate:function(e,t,o){var n=this;i(e.params.collection,e.params.id,(function(e,t,o,l){e?(n.$router.push("/collection/"+n.$router.currentRoute.params.collection),toast(e.toString(),"danger")):(n.collection=o,n.entry=t,n.form=new r.Z(l,!0),n.$emit("updateHead"))})),o()}};function i(e,t,o){axios.get("/api/collections/"+e+"/"+t).then((function(e){var t=e.data.data.matrix,n=e.data.data.entry,l={name:n.name,slug:n.slug,status:n.status,publish_at:n.publish_at,expire_at:n.expire_at};_.forEach(t.blueprint.sections,(function(e){_.forEach(e.fields,(function(e){l[e.handle]=n[e.handle]}))})),o(null,n,t,l)})).catch((function(e){o(new Error("The requested entry could not be found"))}))}const c=(0,o(3744).Z)(a,[["render",function(e,t,o,r,a,i){var c=(0,n.resolveComponent)("page-title"),s=(0,n.resolveComponent)("portal"),u=(0,n.resolveComponent)("shared-form");return(0,n.openBlock)(),(0,n.createElementBlock)("div",l,[(0,n.createVNode)(s,{to:"title"},{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(c,{icon:a.collection.icon||"pencil-alt",subtitle:a.collection.description},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)("Edit "+(0,n.toDisplayString)(a.collection.name),1)]}),void 0,!0),_:1},8,["icon","subtitle"])]}),void 0,!0),_:1}),a.form?((0,n.openBlock)(),(0,n.createBlock)(u,{key:0,loading:a.loading,form:a.form,entry:a.entry,collection:a.collection},null,8,["loading","form","entry","collection"])):(0,n.createCommentVNode)("",!0)])}]])},1690:(e,t,o)=>{o.d(t,{Z:()=>m});var n=o(3802),l={class:"buttons"},r={key:1,class:"entry-slug"},a={key:0,class:"entry-slug__current"},i=(0,n.createElementVNode)("span",{class:"entry-slug__label"},"Slug:",-1),c={class:"entry-slug__value"},s={key:1,class:"entry-slug__edit"},u={key:0,class:"entry-slug__label",for:"edit-slug"};o(161);const d={props:{entry:{required:!1},collection:{required:!0},form:{type:Object,required:!0},loading:{type:Boolean,required:!1}},data:function(){return{editSlug:!1,slugValue:""}},computed:{sections:function(){return{body:_.filter(this.collection.blueprint.sections,(function(e){return"body"==e.placement})),sidebar:_.filter(this.collection.blueprint.sections,(function(e){return"sidebar"==e.placement}))}}},methods:{openEdit:function(){this.slugValue=this.form.slug,this.editSlug=!0,this.slugFocus()},closeEdit:function(){this.slugValue="",this.editSlug=!1,this.editBtnFocus()},saveSlug:function(){""===this.slugValue?this.slugValue=this.form.slug:this.form.slug=this.slugValue,this.closeEdit()},slugFocus:function(){var e=this;this.$nextTick((function(){e.$refs.slug.$el.focus()}))},editBtnFocus:function(){var e=this;this.$nextTick((function(){e.$refs.edit.$el.focus()}))}}};const m=(0,o(3744).Z)(d,[["render",function(e,t,o,d,m,f){var p=(0,n.resolveComponent)("ui-button"),h=(0,n.resolveComponent)("portal"),g=(0,n.resolveComponent)("section-card"),_=(0,n.resolveComponent)("ui-toggle"),V=(0,n.resolveComponent)("ui-flatpickr-group"),k=(0,n.resolveComponent)("sidebar-section"),y=(0,n.resolveComponent)("status-card"),v=(0,n.resolveComponent)("sidebar"),b=(0,n.resolveComponent)("ui-title-group"),C=(0,n.resolveComponent)("ui-slug"),B=(0,n.resolveComponent)("ui-card-body"),x=(0,n.resolveComponent)("ui-card");return(0,n.openBlock)(),(0,n.createElementBlock)("div",null,[(0,n.createVNode)(h,{to:"actions"},{default:(0,n.withCtx)((function(){return[(0,n.createElementVNode)("div",l,[o.collection.slug&&"sm"!=e.$mq?((0,n.openBlock)(),(0,n.createBlock)(p,{key:0,to:{name:"collection.index",params:{collection:o.collection.slug}},variant:"secondary"},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)("Go Back")]}),void 0,!0),_:1},8,["to"])):(0,n.createCommentVNode)("",!0),(0,n.createVNode)(p,{type:"submit",onClick:(0,n.withModifiers)(e.$parent.submit,["prevent"]),variant:"primary",disabled:!o.form.hasChanges||o.loading},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)("Save")]}),void 0,!0),_:1},8,["onClick","disabled"])])]}),void 0,!0),_:1}),(0,n.withDirectives)((0,n.createVNode)(g,{title:"Loading..."},null,512),[[n.vShow,o.loading]]),(0,n.createVNode)(h,{to:"sidebar-right"},{default:(0,n.withCtx)((function(){return[(0,n.withDirectives)((0,n.createElementVNode)("div",null,[o.collection?((0,n.openBlock)(),(0,n.createBlock)(v,{key:0,id:"collection-sidebar"},{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(k,{id:"collection_panel_status",tabindex:"-1"},{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(_,{name:"status",label:"Status",help:o.form.status?"Toggle to disable this entry.":"Toggle to enable this entry.",modelValue:o.form.status,"onUpdate:modelValue":t[0]||(t[0]=function(e){return o.form.status=e}),"true-value":!0,"false-value":!1},null,8,["help","modelValue"]),(0,n.createVNode)(V,{modelValue:o.form.publish_at,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.form.publish_at=e}),name:"publish_at",id:"publish_at",label:"Publish Date","with-time":!0,"has-error":o.form.errors.has("publish_at"),"error-message":o.form.errors.get("publish_at")},null,8,["modelValue","has-error","error-message"]),(0,n.createVNode)(V,{modelValue:o.form.expire_at,"onUpdate:modelValue":t[2]||(t[2]=function(e){return o.form.expire_at=e}),name:"expire_at",id:"expire_at",label:"Expiry Date","with-time":!0,"has-error":o.form.errors.has("expire_at"),"error-message":o.form.errors.get("expire_at")},null,8,["modelValue","has-error","error-message"])]}),void 0,!0),_:1}),e.section.fields.length>0?((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,{key:0},(0,n.renderList)(f.sections.sidebar,(function(e){return(0,n.openBlock)(),(0,n.createBlock)(k,{key:e.handle,id:"collection_panel_"+e.handle,title:e.name,description:e.description,tabindex:"-1"},{default:(0,n.withCtx)((function(){return[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.fields,(function(e){return(0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)(e.type.id+"-fieldtype"),{key:e.handle,field:e,"has-error":o.form.errors.has(e.handle),"error-message":o.form.errors.get(e.handle),modelValue:o.form[e.handle],"onUpdate:modelValue":function(t){return o.form[e.handle]=t}},null,8,["field","has-error","error-message","modelValue","onUpdate:modelValue"])})),128))]}),void 0,!0),_:2},1032,["id","title","description"])})),128)):(0,n.createCommentVNode)("",!0),o.entry?((0,n.openBlock)(),(0,n.createBlock)(y,{key:1,id:"collection_panel_status_card",entry:o.entry,tabindex:"-1"},null,8,["entry"])):(0,n.createCommentVNode)("",!0)]}),void 0,!0),_:1})):(0,n.createCommentVNode)("",!0)],512),[[n.vShow,!o.loading]])]}),void 0,!0),_:1}),(0,n.withDirectives)((0,n.createElementVNode)("div",null,[o.collection.show_name_field?((0,n.openBlock)(),(0,n.createBlock)(x,{key:0,id:"collection_panel_"+o.collection.handle,tabindex:"-1"},{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(B,null,{default:(0,n.withCtx)((function(){return[o.collection.show_name_field?((0,n.openBlock)(),(0,n.createBlock)(b,{key:0,class:"mb-0",name:"name",label:o.collection.name_label||"Name",autocomplete:"off",autofocus:"",required:"",readonly:m.editSlug,placeholder:o.collection.name_label||"Name","has-error":o.form.errors.has("name"),"error-message":o.form.errors.get("name"),modelValue:o.form.name,"onUpdate:modelValue":t[3]||(t[3]=function(e){return o.form.name=e})},null,8,["label","readonly","placeholder","has-error","error-message","modelValue"])):(0,n.createCommentVNode)("",!0),o.form.slug?((0,n.openBlock)(),(0,n.createElementBlock)("div",r,[m.editSlug?(0,n.createCommentVNode)("",!0):((0,n.openBlock)(),(0,n.createElementBlock)("div",a,[i,(0,n.createElementVNode)("span",c,(0,n.toDisplayString)(o.form.slug),1),(0,n.createVNode)(p,{ref:"edit",class:"entry-slug__action",size:"xsmall",onClick:t[4]||(t[4]=(0,n.withModifiers)((function(e){return f.openEdit()}),["prevent"]))},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)("Edit")]}),void 0,!0),_:1},512)])),m.editSlug?((0,n.openBlock)(),(0,n.createElementBlock)("div",s,[m.editSlug?((0,n.openBlock)(),(0,n.createElementBlock)("label",u,"Slug:")):(0,n.createCommentVNode)("",!0),(0,n.createVNode)(C,{ref:"slug",class:"field--xs",id:"edit-slug",name:"edit_slug",monospaced:"",autocomplete:"off",modelValue:m.slugValue,"onUpdate:modelValue":t[5]||(t[5]=function(e){return m.slugValue=e})},null,8,["modelValue"]),(0,n.createVNode)(p,{class:"entry-slug__action",variant:"primary",size:"xsmall",onClick:t[6]||(t[6]=(0,n.withModifiers)((function(e){return f.saveSlug()}),["prevent"]))},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)("Apply")]}),void 0,!0),_:1}),(0,n.createVNode)(p,{class:"entry-slug__action",variant:"secondary",size:"xsmall",onClick:t[7]||(t[7]=(0,n.withModifiers)((function(e){return f.closeEdit()}),["prevent"]))},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)("Cancel")]}),void 0,!0),_:1})])):(0,n.createCommentVNode)("",!0)])):(0,n.createCommentVNode)("",!0),o.collection.show_name_field||o.entry.id?((0,n.openBlock)(),(0,n.createBlock)(C,{key:2,type:"hidden",name:"slug",label:"Slug",monospaced:"",autocomplete:"off",required:"",help:o.collection.show_name_field?"":"This field is auto-generated based on pattern specified.",watch:o.form.name,readonly:!o.collection.show_name_field,"has-error":o.form.errors.has("slug"),"error-message":o.form.errors.get("slug"),modelValue:o.form.slug,"onUpdate:modelValue":t[8]||(t[8]=function(e){return o.form.slug=e})},null,8,["help","watch","readonly","has-error","error-message","modelValue"])):(0,n.createCommentVNode)("",!0)]}),void 0,!0),_:1})]}),void 0,!0),_:1},8,["id"])):(0,n.createCommentVNode)("",!0),e.section.fields.length>0?((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,{key:1},(0,n.renderList)(f.sections.body,(function(e){return(0,n.openBlock)(),(0,n.createBlock)(g,{key:e.handle,id:"collection_panel_"+e.handle,title:e.name,description:e.description,tabindex:"-1"},{default:(0,n.withCtx)((function(){return[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.fields,(function(e){return(0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)(e.type.id+"-fieldtype"),{key:e.handle,field:e,errors:o.form.errors,modelValue:o.form[e.handle],"onUpdate:modelValue":function(t){return o.form[e.handle]=t}},null,8,["field","errors","modelValue","onUpdate:modelValue"])})),128))]}),void 0,!0),_:2},1032,["id","title","description"])})),128)):(0,n.createCommentVNode)("",!0)],512),[[n.vShow,!o.loading]])])}]])}}]);