"use strict";(self.webpackChunkfusioncms=self.webpackChunkfusioncms||[]).push([[3371],{3371:(e,t,o)=>{o.r(t),o.d(t,{default:()=>k});var n=o(3802),r={class:"preview"},i=["aria-hidden"],s={class:"controls__header"},a={class:"px-3 py-3"},l={class:"controls__content"},c={class:"p-3"},d={key:0,class:"text-sm"},u={class:"controls__footer"},h={class:"flex border-l border-gray-300"},f={class:"preview__window flex-col"},m={class:"w-full px-2 bg-white border-b border-gray-300 flex items-center py-1"},p={class:"px-6 py-2 bg-gray-200 rounded-full text-gray-700 flex flex-1 mr-2 items-center leading-none"};var w,b=o(8401),v=o(6486),g=o.n(v),y=axios.CancelToken;const C={head:{title:function(){return{inner:"Customize"}}},data:function(){return{theme:{},form:null,url:"/customize",history:[],current:0,window:"desktop",showControls:!0}},computed:{isDesktop:function(){return"desktop"==this.window},isTablet:function(){return"tablet"==this.window},isMobile:function(){return"mobile"==this.window},prettyURL:function(){var e=this.url.replace(/([^:]\/)\/+/g,"$1");return this.parseURL(e)}},watch:{"theme.option":{handler:function(){this.update()},deep:!0}},methods:{navigateBack:function(){if(this.history.length>0){var e=this.current-1,t=this.history[this.history.length-1+e];t&&(this.current=e,this.url=t,this.update())}},navigateForward:function(){if(0!==this.current){var e=this.current+1,t=this.history[this.history.length-1+e];t&&(this.current=e,this.url=t,this.update())}},navigateRefresh:function(){this.update()},navigateHome:function(){this.url="/customize",this.update()},update:g().debounce((function(){var e=this;null!=w&&w(),axios({method:"post",url:this.url,data:this.theme.option,cancelToken:new y((function(e){w=e}))}).then((function(t){e.updateIframe(t.data)})).catch((function(e){if(!axios.isCancel(e))throw e}))}),150),updateIframe:function(e){var t=this.$refs.iframe;t.contentWindow.document.open(),t.contentWindow.document.write(e),t.contentWindow.document.close()},onLoadIframe:function(e){var t=this.$refs.iframe.contentWindow.location.toString();"about:blank"==t?(this.url="/customize",this.history[this.history.length-1]!=this.url&&(this.history.push(this.url),this.current=0),this.update()):g().endsWith(t,"/customize")||(this.url=t+"/customize",this.history[this.history.length-1]!=this.url&&(this.history.push(this.url),this.current=0),this.update()),this.history[this.history.length+this.current]==this.url&&(this.current=this.current+1)},parseURL:function(e){var t=document.createElement("a");return t.href=e,t},submit:function(){this.form.patch("/api/themes/"+this.theme.namespace).then((function(e){toast("Theme options have been updated","success")})).catch((function(e){toast(e.response.data.message,"failed")}))},setWindow:function(e){this.window=e},toggleControls:function(){this.showControls=!this.showControls,this.$nextTick((function(){this.showControls?this.$refs["hide-controls"].focus():this.$refs["show-controls"].focus()}))}},beforeRouteEnter:function(e,t,o){axios.all([axios.get("/api/theme")]).then(axios.spread((function(e){o((function(t){var o=e.data.data.option;g().unset(o,"_json"),t.theme=e.data.data,t.form=new b.Z(o,!0)}))})))}};const k=(0,o(3744).Z)(C,[["render",function(e,t,o,w,b,v){var g=(0,n.resolveComponent)("fa-icon"),y=(0,n.resolveComponent)("router-link"),C=(0,n.resolveComponent)("ui-accordion-item"),k=(0,n.resolveComponent)("ui-accordion"),V=(0,n.resolveComponent)("confirm-modal");return(0,n.openBlock)(),(0,n.createElementBlock)("div",r,[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)(["preview__controls",{"w-0 border-0":!b.showControls}]),"aria-hidden":!b.showControls},[(0,n.createElementVNode)("button",{onClick:t[0]||(t[0]=function(){return v.toggleControls&&v.toggleControls.apply(v,arguments)}),ref:"show-controls",class:(0,n.normalizeClass)(["simple-button show-controls-button",{hidden:b.showControls,"inline-block":!b.showControls}])},[(0,n.createVNode)(g,{icon:["fas","caret-square-right"],class:"fa-fw"}),(0,n.createTextVNode)(" Show Controls")],2),(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)(["controls",{hidden:!b.showControls}])},[(0,n.createElementVNode)("div",s,[(0,n.createVNode)(y,{exact:"",to:{name:"dashboard"},class:"flex items-center px-3 py-2 border-r border-gray-300 leading-none"},{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(g,{icon:["fas","times"],class:"fa-fw"})]}),void 0,!0),_:1}),(0,n.createElementVNode)("div",a,[(0,n.createElementVNode)("button",{type:"submit",onClick:t[1]||(t[1]=(0,n.withModifiers)((function(){return v.submit&&v.submit.apply(v,arguments)}),["prevent"])),class:"button button--primary button--small"},"Save")])]),(0,n.createElementVNode)("div",l,[(0,n.createVNode)(k,{multiple:!0},{default:(0,n.withCtx)((function(){return[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(b.theme.options,(function(e,t){return(0,n.openBlock)(),(0,n.createBlock)(C,{key:e.handle,title:e.name},{default:(0,n.withCtx)((function(){return[(0,n.createElementVNode)("div",c,[e.description?((0,n.openBlock)(),(0,n.createElementBlock)("p",d,(0,n.toDisplayString)(e.description),1)):(0,n.createCommentVNode)("",!0),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.fields,(function(e,o){return(0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)(e.fieldtype+"-fieldtype"),{modelValue:b.form[t][o],"onUpdate:modelValue":function(e){return b.form[t][o]=e},key:o,field:{name:e.name,handle:t,help:e.help,settings:e.settings||{}},class:"mb-8"},null,8,["modelValue","onUpdate:modelValue","field"])})),128))])]}),void 0,!0),_:2},1032,["title"])})),128))]}),void 0,!0),_:1})]),(0,n.createElementVNode)("div",u,[(0,n.createElementVNode)("button",{onClick:t[2]||(t[2]=function(){return v.toggleControls&&v.toggleControls.apply(v,arguments)}),ref:"hide-controls",class:"simple-button hide-controls-button"},[(0,n.createVNode)(g,{icon:["fas","caret-square-left"],class:"fa-fw"}),(0,n.createTextVNode)(" Hide Controls")],512),(0,n.createElementVNode)("div",h,[(0,n.createElementVNode)("button",{onClick:t[3]||(t[3]=function(e){return v.setWindow("desktop")}),class:(0,n.normalizeClass)(["simple-button relative inline-flex items-center px-3 py-2 border-b-4 border-gray-300 hover:border-gray-500",{"hover:border-primary-500 border-primary-500":v.isDesktop}])},[(0,n.createVNode)(g,{icon:["fas","desktop"],class:"fa-fw"})],2),(0,n.createElementVNode)("button",{onClick:t[4]||(t[4]=function(e){return v.setWindow("tablet")}),class:(0,n.normalizeClass)(["simple-button relative inline-flex items-center px-3 py-2 border-b-4 border-gray-300 hover:border-gray-500",{"hover:border-primary-500 border-primary-500":v.isTablet}])},[(0,n.createVNode)(g,{icon:["fas","tablet-alt"],class:"fa-fw"})],2),(0,n.createElementVNode)("button",{onClick:t[5]||(t[5]=function(e){return v.setWindow("mobile")}),class:(0,n.normalizeClass)(["simple-button relative inline-flex items-center px-3 py-2 border-b-4 border-gray-300 hover:border-gray-500",{"hover:border-primary-500 border-primary-500":v.isMobile}])},[(0,n.createVNode)(g,{icon:["fas","mobile-alt"],class:"fa-fw"})],2)])])],2)],10,i),(0,n.createElementVNode)("div",f,[(0,n.createElementVNode)("div",m,[(0,n.createElementVNode)("button",{class:"mr-1 w-8 h-8 focus:outline-none hover:bg-gray-200 rounded-full",onClick:t[6]||(t[6]=(0,n.withModifiers)((function(){return v.navigateBack&&v.navigateBack.apply(v,arguments)}),["prevent"]))},[(0,n.createVNode)(g,{icon:["fas","arrow-left"],class:"fa-fw text-gray-700"})]),(0,n.createElementVNode)("button",{class:"mr-1 w-8 h-8 focus:outline-none hover:bg-gray-200 rounded-full",onClick:t[7]||(t[7]=(0,n.withModifiers)((function(){return v.navigateForward&&v.navigateForward.apply(v,arguments)}),["prevent"]))},[(0,n.createVNode)(g,{icon:["fas","arrow-right"],class:"fa-fw text-gray-700"})]),(0,n.createElementVNode)("button",{class:"mr-1 w-8 h-8 focus:outline-none hover:bg-gray-200 rounded-full",onClick:t[8]||(t[8]=(0,n.withModifiers)((function(){return v.navigateRefresh&&v.navigateRefresh.apply(v,arguments)}),["prevent"]))},[(0,n.createVNode)(g,{icon:["fas","redo"],class:"fa-fw text-gray-700"})]),(0,n.createElementVNode)("button",{class:"mr-1 w-8 h-8 focus:outline-none hover:bg-gray-200 rounded-full",onClick:t[9]||(t[9]=(0,n.withModifiers)((function(){return v.navigateHome&&v.navigateHome.apply(v,arguments)}),["prevent"]))},[(0,n.createVNode)(g,{icon:["fas","home"],class:"fa-fw text-gray-700"})]),(0,n.createElementVNode)("div",p,[(0,n.createElementVNode)("span",null,(0,n.toDisplayString)(v.prettyURL),1)])]),(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)(["window","window--"+b.window])},[(0,n.createElementVNode)("iframe",{ref:"iframe",onLoad:t[10]||(t[10]=function(){return v.onLoadIframe&&v.onLoadIframe.apply(v,arguments)})},null,544)],2)]),(0,n.createVNode)(V)])}]])}}]);