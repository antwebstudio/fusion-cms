"use strict";(self.webpackChunkfusioncms=self.webpackChunkfusioncms||[]).push([[1898],{1381:(e,t,o)=>{o.d(t,{Z:()=>r});const r={methods:{isAssignable:function(e,t){return!_.includes(["guest"],e)&&this.$level(t)},isRemovable:function(e,t){return!_.includes(["owner","user","guest"],e)&&this.$level(t)},hasPermissions:function(e){return!_.includes(["owner"],e)}}}},1898:(e,t,o)=>{o.r(t),o.d(t,{default:()=>d});var r=o(3802),n={class:"roles-page"},a={key:1},l={class:"text-gray-800 text-sm"},i={"slot-scope":"role"},c=(0,r.createElementVNode)("p",null,"Please select another role to move users to.",-1);const s={auth:function(){return{permission:"roles.viewAny"}},head:{title:function(){return{inner:"Roles"}}},mixins:[o(1381).Z],data:function(){return{transfer:"",roles:[]}},methods:{roleOptions:function(e){var t=_.reject(this.roles,(function(t){return e==t.handle}));return _.map(t,(function(e){return{label:e.name,value:e.handle}}))},destroy:function(e){var t=this;axios.delete("/api/roles/".concat(e),{data:{transfer:this.transfer}}).then((function(e){t.transfer="",toast("Role successfully deleted.","success"),bus().$emit("refresh-datatable-roles"),axios.get("/api/roles").then((function(e){t.roles=e.data.data})).catch((function(e){toast(e.message,"failed")}))})).catch((function(e){toast(e.message,"failed")}))},isOwner:function(e){return e&&1===e}},created:function(){var e=this;bus().$on("modal-opened",(function(t){"delete-role"==t&&(e.transfer="")}))},beforeRouteEnter:function(e,t,o){axios.get("/api/roles").then((function(e){o((function(t){return t.roles=e.data.data}))})).catch((function(e){o((function(e){e.$router.push("/roles"),toast(error.toString(),"danger")}))}))}};const d=(0,o(3744).Z)(s,[["render",function(e,t,o,s,d,u){var f=(0,r.resolveComponent)("page-title"),m=(0,r.resolveComponent)("portal"),p=(0,r.resolveComponent)("ui-button"),v=(0,r.resolveComponent)("router-link"),h=(0,r.resolveComponent)("ui-badge"),C=(0,r.resolveComponent)("ui-dropdown-link"),k=(0,r.resolveComponent)("ui-dropdown-divider"),w=(0,r.resolveComponent)("ui-actions"),x=(0,r.resolveComponent)("ui-table"),V=(0,r.resolveComponent)("ui-card-body"),_=(0,r.resolveComponent)("ui-card"),N=(0,r.resolveComponent)("ui-select-group"),g=(0,r.resolveComponent)("ui-modal"),B=(0,r.resolveDirective)("modal");return(0,r.openBlock)(),(0,r.createElementBlock)("div",n,[(0,r.createVNode)(m,{to:"title"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(f,{icon:"user-shield"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Roles")]}),void 0,!0),_:1})]}),void 0,!0),_:1}),(0,r.createVNode)(m,{to:"actions"},{default:(0,r.withCtx)((function(){return[e.$can("roles.create")?((0,r.openBlock)(),(0,r.createBlock)(p,{key:"create-role-btn",to:{name:"roles.create"},variant:"primary"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Create Role")]}),void 0,!0),_:1},8,["to"])):(0,r.createCommentVNode)("",!0)]}),void 0,!0),_:1}),(0,r.createVNode)(_,null,{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(V,null,{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(x,{key:"roles",class:"roles-table",id:"roles",endpoint:"/datatable/roles","sort-by":"order","show-page-status":"","show-page-numbers":"","show-page-nav":"","show-page-ends":"",link_name:"roles.edit",link_param:"role",reorder_route:"/api/roles/reorder",show_status:!1},{name:(0,r.withCtx)((function(t){return[e.$can("roles.view")?((0,r.openBlock)(),(0,r.createBlock)(v,{key:0,to:{name:"roles.show",params:{role:t.record.id}}},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)((0,r.toDisplayString)(t.record.name),1)]}),void 0,!0),_:2},1032,["to"])):((0,r.openBlock)(),(0,r.createElementBlock)("span",a,(0,r.toDisplayString)(t.record.name),1))]})),level:(0,r.withCtx)((function(e){return[(0,r.createVNode)(h,null,{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)((0,r.toDisplayString)(e.record.level),1)]}),void 0,!0),_:2},1024)]})),description:(0,r.withCtx)((function(e){return[(0,r.createElementVNode)("span",l,(0,r.toDisplayString)(e.record.description),1)]})),actions:(0,r.withCtx)((function(o){return[((0,r.openBlock)(),(0,r.createBlock)(w,{id:"role_"+o.record.id+"_actions",key:"role_"+o.record.id+"_actions"},{default:(0,r.withCtx)((function(){return[e.$can("roles.view")?((0,r.openBlock)(),(0,r.createBlock)(C,{key:0,to:{name:"roles.show",params:{role:o.record.id}}},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)(" View ")]}),void 0,!0),_:2},1032,["to"])):(0,r.createCommentVNode)("",!0),!u.isOwner(o.record.id)&&e.$can("roles.update",o.record.level)?((0,r.openBlock)(),(0,r.createBlock)(C,{key:1,onClick:t[0]||(t[0]=(0,r.withModifiers)((function(){}),["prevent"])),to:{name:"roles.edit",params:{role:o.record.id}}},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)(" Edit ")]}),void 0,!0),_:2},1032,["to"])):(0,r.createCommentVNode)("",!0),e.isRemovable(o.record.handle)&&e.$can("roles.delete",o.record.level)?((0,r.openBlock)(),(0,r.createBlock)(k,{key:2})):(0,r.createCommentVNode)("",!0),e.isRemovable(o.record.handle)&&e.$can("roles.delete",o.record.level)?(0,r.withDirectives)(((0,r.openBlock)(),(0,r.createBlock)(C,{key:3,onClick:t[1]||(t[1]=(0,r.withModifiers)((function(){}),["prevent"])),class:"danger"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)(" Delete ")]}),void 0,!0),_:2},1024)),[[B,o.record,"delete-role"]]):(0,r.createCommentVNode)("",!0)]}),void 0,!0),_:2},1032,["id"]))]})),_:1})]}),void 0,!0),_:1})]}),void 0,!0),_:1}),(0,r.createVNode)(m,{to:"modals"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(g,{name:"delete-role",title:"Delete Role"},{footer:(0,r.withCtx)((function(e){return[(0,r.withDirectives)(((0,r.openBlock)(),(0,r.createBlock)(p,{onClick:function(t){return u.destroy(e.data.id)},variant:"danger",class:"ml-3",disabled:0==d.transfer.length},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Delete")]}),void 0,!0),_:2},1032,["onClick","disabled"])),[[B,void 0,"delete-role"]]),(0,r.withDirectives)(((0,r.openBlock)(),(0,r.createBlock)(p,{variant:"secondary"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Cancel")]}),void 0,!0),_:1})),[[B,void 0,"delete-role"]])]})),default:(0,r.withCtx)((function(){return[(0,r.createElementVNode)("template",i,[c,e.role.data?((0,r.openBlock)(),(0,r.createBlock)(N,{key:0,id:"move-role",name:"move_role",label:"Transfer to Role",options:u.roleOptions(e.role.data.handle),autocomplete:"off",modelValue:d.transfer,"onUpdate:modelValue":t[2]||(t[2]=function(e){return d.transfer=e})},null,8,["options","modelValue"])):(0,r.createCommentVNode)("",!0)])]}),void 0,!0),_:1})]}),void 0,!0),_:1})])}]])}}]);