"use strict";(self.webpackChunkfusioncms=self.webpackChunkfusioncms||[]).push([[5507],{5507:(e,t,o)=>{o.r(t),o.d(t,{default:()=>i});var l=o(3802),n={class:"collection-page"};var r=o(8401);const a={head:{title:function(){return{inner:this.collection.name||"Loading..."}}},data:function(){return{collection:{},form:null,loading:!1}},components:{"shared-form":o(1690).Z},methods:{submit:function(){var e=this;this.loading=!0,this.form.post("/api/collections/".concat(this.collection.slug)).then((function(t){toast("Entry saved successfully","success"),e.$router.push("/collection/".concat(e.collection.slug))})).catch((function(t){toast(t.message,"failed"),e.loading=!1}))}},beforeRouteEnter:function(e,t,o){axios.get("/api/matrices/slug/".concat(e.params.collection)).then((function(e){o((function(t){var o=e.data.data,l={name:"",slug:"",publish_at:null,expire_at:null,status:1};_.each(o.blueprint.sections,(function(e){_.each(e.fields,(function(e){l[e.handle]=e.default}))})),t.collection=o,t.form=new r.Z(l,!0),t.$emit("updateHead")}))})).catch((function(){vm.$router.push("/collection/".concat(vm.$router.currentRoute.params.collection)),toast("Requested entry could not be found.","danger")}))}};const i=(0,o(3744).Z)(a,[["render",function(e,t,o,r,a,i){var c=(0,l.resolveComponent)("page-title"),s=(0,l.resolveComponent)("portal"),u=(0,l.resolveComponent)("shared-form");return(0,l.openBlock)(),(0,l.createElementBlock)("div",n,[(0,l.createVNode)(s,{to:"title"},{default:(0,l.withCtx)((function(){return[(0,l.createVNode)(c,{icon:a.collection.icon||"pencil-alt",subtitle:a.collection.description},{default:(0,l.withCtx)((function(){return[(0,l.createTextVNode)("Create")]}),void 0,!0),_:1},8,["icon","subtitle"])]}),void 0,!0),_:1}),a.form?((0,l.openBlock)(),(0,l.createBlock)(u,{key:0,loading:a.loading,form:a.form,collection:a.collection},null,8,["loading","form","collection"])):(0,l.createCommentVNode)("",!0)])}]])},1690:(e,t,o)=>{o.d(t,{Z:()=>m});var l=o(3802),n={class:"buttons"},r={key:1,class:"entry-slug"},a={key:0,class:"entry-slug__current"},i=(0,l.createElementVNode)("span",{class:"entry-slug__label"},"Slug:",-1),c={class:"entry-slug__value"},s={key:1,class:"entry-slug__edit"},u={key:0,class:"entry-slug__label",for:"edit-slug"};o(161);const d={props:{entry:{required:!1},collection:{required:!0},form:{type:Object,required:!0},loading:{type:Boolean,required:!1}},data:function(){return{editSlug:!1,slugValue:""}},computed:{sections:function(){return{body:_.filter(this.collection.blueprint.sections,(function(e){return"body"==e.placement})),sidebar:_.filter(this.collection.blueprint.sections,(function(e){return"sidebar"==e.placement}))}}},methods:{openEdit:function(){this.slugValue=this.form.slug,this.editSlug=!0,this.slugFocus()},closeEdit:function(){this.slugValue="",this.editSlug=!1,this.editBtnFocus()},saveSlug:function(){""===this.slugValue?this.slugValue=this.form.slug:this.form.slug=this.slugValue,this.closeEdit()},slugFocus:function(){var e=this;this.$nextTick((function(){e.$refs.slug.$el.focus()}))},editBtnFocus:function(){var e=this;this.$nextTick((function(){e.$refs.edit.$el.focus()}))}}};const m=(0,o(3744).Z)(d,[["render",function(e,t,o,d,m,f){var p=(0,l.resolveComponent)("ui-button"),h=(0,l.resolveComponent)("portal"),g=(0,l.resolveComponent)("section-card"),V=(0,l.resolveComponent)("ui-toggle"),_=(0,l.resolveComponent)("ui-flatpickr-group"),k=(0,l.resolveComponent)("sidebar-section"),v=(0,l.resolveComponent)("status-card"),y=(0,l.resolveComponent)("sidebar"),b=(0,l.resolveComponent)("ui-title-group"),C=(0,l.resolveComponent)("ui-slug"),B=(0,l.resolveComponent)("ui-card-body"),x=(0,l.resolveComponent)("ui-card");return(0,l.openBlock)(),(0,l.createElementBlock)("div",null,[(0,l.createVNode)(h,{to:"actions"},{default:(0,l.withCtx)((function(){return[(0,l.createElementVNode)("div",n,[o.collection.slug&&"sm"!=e.$mq?((0,l.openBlock)(),(0,l.createBlock)(p,{key:0,to:{name:"collection.index",params:{collection:o.collection.slug}},variant:"secondary"},{default:(0,l.withCtx)((function(){return[(0,l.createTextVNode)("Go Back")]}),void 0,!0),_:1},8,["to"])):(0,l.createCommentVNode)("",!0),(0,l.createVNode)(p,{type:"submit",onClick:(0,l.withModifiers)(e.$parent.submit,["prevent"]),variant:"primary",disabled:!o.form.hasChanges||o.loading},{default:(0,l.withCtx)((function(){return[(0,l.createTextVNode)("Save")]}),void 0,!0),_:1},8,["onClick","disabled"])])]}),void 0,!0),_:1}),(0,l.withDirectives)((0,l.createVNode)(g,{title:"Loading..."},null,512),[[l.vShow,o.loading]]),(0,l.createVNode)(h,{to:"sidebar-right"},{default:(0,l.withCtx)((function(){return[(0,l.withDirectives)((0,l.createElementVNode)("div",null,[o.collection?((0,l.openBlock)(),(0,l.createBlock)(y,{key:0,id:"collection-sidebar"},{default:(0,l.withCtx)((function(){return[(0,l.createVNode)(k,{id:"collection_panel_status",tabindex:"-1"},{default:(0,l.withCtx)((function(){return[(0,l.createVNode)(V,{name:"status",label:"Status",help:o.form.status?"Toggle to disable this entry.":"Toggle to enable this entry.",modelValue:o.form.status,"onUpdate:modelValue":t[0]||(t[0]=function(e){return o.form.status=e}),"true-value":!0,"false-value":!1},null,8,["help","modelValue"]),(0,l.createVNode)(_,{modelValue:o.form.publish_at,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.form.publish_at=e}),name:"publish_at",id:"publish_at",label:"Publish Date","with-time":!0,"has-error":o.form.errors.has("publish_at"),"error-message":o.form.errors.get("publish_at")},null,8,["modelValue","has-error","error-message"]),(0,l.createVNode)(_,{modelValue:o.form.expire_at,"onUpdate:modelValue":t[2]||(t[2]=function(e){return o.form.expire_at=e}),name:"expire_at",id:"expire_at",label:"Expiry Date","with-time":!0,"has-error":o.form.errors.has("expire_at"),"error-message":o.form.errors.get("expire_at")},null,8,["modelValue","has-error","error-message"])]}),void 0,!0),_:1}),e.section.fields.length>0?((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,{key:0},(0,l.renderList)(f.sections.sidebar,(function(e){return(0,l.openBlock)(),(0,l.createBlock)(k,{key:e.handle,id:"collection_panel_"+e.handle,title:e.name,description:e.description,tabindex:"-1"},{default:(0,l.withCtx)((function(){return[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.fields,(function(e){return(0,l.openBlock)(),(0,l.createBlock)((0,l.resolveDynamicComponent)(e.type.id+"-fieldtype"),{key:e.handle,field:e,"has-error":o.form.errors.has(e.handle),"error-message":o.form.errors.get(e.handle),modelValue:o.form[e.handle],"onUpdate:modelValue":function(t){return o.form[e.handle]=t}},null,8,["field","has-error","error-message","modelValue","onUpdate:modelValue"])})),128))]}),void 0,!0),_:2},1032,["id","title","description"])})),128)):(0,l.createCommentVNode)("",!0),o.entry?((0,l.openBlock)(),(0,l.createBlock)(v,{key:1,id:"collection_panel_status_card",entry:o.entry,tabindex:"-1"},null,8,["entry"])):(0,l.createCommentVNode)("",!0)]}),void 0,!0),_:1})):(0,l.createCommentVNode)("",!0)],512),[[l.vShow,!o.loading]])]}),void 0,!0),_:1}),(0,l.withDirectives)((0,l.createElementVNode)("div",null,[o.collection.show_name_field?((0,l.openBlock)(),(0,l.createBlock)(x,{key:0,id:"collection_panel_"+o.collection.handle,tabindex:"-1"},{default:(0,l.withCtx)((function(){return[(0,l.createVNode)(B,null,{default:(0,l.withCtx)((function(){return[o.collection.show_name_field?((0,l.openBlock)(),(0,l.createBlock)(b,{key:0,class:"mb-0",name:"name",label:o.collection.name_label||"Name",autocomplete:"off",autofocus:"",required:"",readonly:m.editSlug,placeholder:o.collection.name_label||"Name","has-error":o.form.errors.has("name"),"error-message":o.form.errors.get("name"),modelValue:o.form.name,"onUpdate:modelValue":t[3]||(t[3]=function(e){return o.form.name=e})},null,8,["label","readonly","placeholder","has-error","error-message","modelValue"])):(0,l.createCommentVNode)("",!0),o.form.slug?((0,l.openBlock)(),(0,l.createElementBlock)("div",r,[m.editSlug?(0,l.createCommentVNode)("",!0):((0,l.openBlock)(),(0,l.createElementBlock)("div",a,[i,(0,l.createElementVNode)("span",c,(0,l.toDisplayString)(o.form.slug),1),(0,l.createVNode)(p,{ref:"edit",class:"entry-slug__action",size:"xsmall",onClick:t[4]||(t[4]=(0,l.withModifiers)((function(e){return f.openEdit()}),["prevent"]))},{default:(0,l.withCtx)((function(){return[(0,l.createTextVNode)("Edit")]}),void 0,!0),_:1},512)])),m.editSlug?((0,l.openBlock)(),(0,l.createElementBlock)("div",s,[m.editSlug?((0,l.openBlock)(),(0,l.createElementBlock)("label",u,"Slug:")):(0,l.createCommentVNode)("",!0),(0,l.createVNode)(C,{ref:"slug",class:"field--xs",id:"edit-slug",name:"edit_slug",monospaced:"",autocomplete:"off",modelValue:m.slugValue,"onUpdate:modelValue":t[5]||(t[5]=function(e){return m.slugValue=e})},null,8,["modelValue"]),(0,l.createVNode)(p,{class:"entry-slug__action",variant:"primary",size:"xsmall",onClick:t[6]||(t[6]=(0,l.withModifiers)((function(e){return f.saveSlug()}),["prevent"]))},{default:(0,l.withCtx)((function(){return[(0,l.createTextVNode)("Apply")]}),void 0,!0),_:1}),(0,l.createVNode)(p,{class:"entry-slug__action",variant:"secondary",size:"xsmall",onClick:t[7]||(t[7]=(0,l.withModifiers)((function(e){return f.closeEdit()}),["prevent"]))},{default:(0,l.withCtx)((function(){return[(0,l.createTextVNode)("Cancel")]}),void 0,!0),_:1})])):(0,l.createCommentVNode)("",!0)])):(0,l.createCommentVNode)("",!0),o.collection.show_name_field||o.entry.id?((0,l.openBlock)(),(0,l.createBlock)(C,{key:2,type:"hidden",name:"slug",label:"Slug",monospaced:"",autocomplete:"off",required:"",help:o.collection.show_name_field?"":"This field is auto-generated based on pattern specified.",watch:o.form.name,readonly:!o.collection.show_name_field,"has-error":o.form.errors.has("slug"),"error-message":o.form.errors.get("slug"),modelValue:o.form.slug,"onUpdate:modelValue":t[8]||(t[8]=function(e){return o.form.slug=e})},null,8,["help","watch","readonly","has-error","error-message","modelValue"])):(0,l.createCommentVNode)("",!0)]}),void 0,!0),_:1})]}),void 0,!0),_:1},8,["id"])):(0,l.createCommentVNode)("",!0),e.section.fields.length>0?((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,{key:1},(0,l.renderList)(f.sections.body,(function(e){return(0,l.openBlock)(),(0,l.createBlock)(g,{key:e.handle,id:"collection_panel_"+e.handle,title:e.name,description:e.description,tabindex:"-1"},{default:(0,l.withCtx)((function(){return[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.fields,(function(e){return(0,l.openBlock)(),(0,l.createBlock)((0,l.resolveDynamicComponent)(e.type.id+"-fieldtype"),{key:e.handle,field:e,errors:o.form.errors,modelValue:o.form[e.handle],"onUpdate:modelValue":function(t){return o.form[e.handle]=t}},null,8,["field","errors","modelValue","onUpdate:modelValue"])})),128))]}),void 0,!0),_:2},1032,["id","title","description"])})),128)):(0,l.createCommentVNode)("",!0)],512),[[l.vShow,!o.loading]])])}]])}}]);