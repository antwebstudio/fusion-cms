"use strict";(self.webpackChunkfusioncms=self.webpackChunkfusioncms||[]).push([[2185],{2185:(e,t,o)=>{o.r(t),o.d(t,{default:()=>l,getForm:()=>i});var r=o(3802);var n=o(8401);const a={auth:function(){return{permission:"forms.update"}},head:{title:function(){return{inner:_.has(this.form,"name")?this.form.name:"Loading..."}}},data:function(){return{id:null,resource:null,form:null,loading:!1}},components:{"shared-form":o(9489).Z},methods:{submit:function(){var e=this;this.loading=!0,this.form.patch("/api/forms/".concat(this.id)).then((function(){axios.post("/api/blueprints/".concat(e.resource.blueprint.id,"/sections"),{sections:e.form.sections}).then((function(){toast("Form successfully saved","success"),e.loading=!1})).catch((function(t){toast(t.message,"failed"),e.loading=!1}))})).catch((function(t){toast(t.message,"failed"),e.loading=!1}))}},beforeRouteEnter:function(e,t,o){i(e.params.form,(function(e,t){o(e?function(t){t.$router.push("/forms"),toast(e.toString(),"danger")}:function(e){e.id=t.id,e.resource=t,e.form=new n.Z({name:t.name,handle:t.handle,description:t.description,sections:t.blueprint.sections,collect_email_addresses:t.collect_email_addresses,collect_ip_addresses:t.collect_ip_addresses,response_receipt:t.response_receipt,confirmation_message:t.confirmation_message,redirect_on_submission:t.redirect_on_submission,redirect_url:t.redirect_url,enable_recaptcha:t.enable_recaptcha,enable_honeypot:t.enable_honeypot,send_to:t.send_to,reply_to:t.reply_to,form_template:t.form_template,thankyou_template:t.thankyou_template,status:t.status},!0),e.$nextTick((function(){window.emitter.emit("updateHead")}))})}))}};function i(e,t){axios.get("/api/forms/"+e).then((function(e){t(null,e.data.data)})).catch((function(e){t(new Error("The requested form could not be found"))}))}const l=(0,o(3744).Z)(a,[["render",function(e,t,o,n,a,i){var l=(0,r.resolveComponent)("page-title"),s=(0,r.resolveComponent)("portal"),d=(0,r.resolveComponent)("shared-form");return(0,r.openBlock)(),(0,r.createElementBlock)("div",null,[(0,r.createVNode)(s,{to:"title"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(l,{icon:"paper-plane"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Edit Form")]}),void 0,!0),_:1})]}),void 0,!0),_:1}),a.form?((0,r.openBlock)(),(0,r.createBlock)(d,{key:0,loading:a.loading,form:a.form,resource:a.resource},null,8,["loading","form","resource"])):(0,r.createCommentVNode)("",!0)])}]])},9489:(e,t,o)=>{o.d(t,{Z:()=>i});var r=o(3802),n={class:"buttons"};const a={data:function(){return{ready:!1,fieldtype:{},placements:[{label:"Body",value:"body"},{label:"Sidebar",value:"sidebar"}]}},props:{form:{type:Object,required:!0},resource:{type:Object,required:!1,default:function(){}},loading:{type:Boolean,required:!1}},watch:{"form.collect_email_addresses":function(e){this.ready&&(!1===e?(this.form.response_receipt=!1,this.removeIdentifiableEmailField()):this.addIdentifiableEmailField())},"form.sections":{deep:!0,handler:function(e){this.form.collect_email_addresses=this.hasIdentifiableEmailField}}},computed:{hasIdentifiableEmailField:function(){return-1!=_.findIndex(this.form.sections[0].fields,(function(e){return e.settings.identifiable}))}},methods:{addIdentifiableEmailField:function(){bus().$emit("add-field-".concat(this.form.sections[0].handle),{type:this.fieldtype,settings:{identifiable:!0}})},removeIdentifiableEmailField:function(){bus().$emit("remove-field-".concat(this.form.sections[0].handle),"settings.identifiable",!0)},handleSave:function(){this.$parent.submit()}},created:function(){var e=this;this.$store.commit("fieldtypes/setStructure","forms"),axios.all([axios.get("/api/fieldtypes/email")]).then(axios.spread((function(t){e.fieldtype=t.data,e.ready=!0})))}};const i=(0,o(3744).Z)(a,[["render",function(e,t,o,a,i,l){var s=(0,r.resolveComponent)("ui-button"),d=(0,r.resolveComponent)("portal"),m=(0,r.resolveComponent)("section-card"),c=(0,r.resolveComponent)("ui-toggle"),u=(0,r.resolveComponent)("sidebar-section"),f=(0,r.resolveComponent)("fa-icon"),p=(0,r.resolveComponent)("ui-definition"),h=(0,r.resolveComponent)("ui-definition-list"),_=(0,r.resolveComponent)("sidebar"),V=(0,r.resolveComponent)("ui-input-group"),g=(0,r.resolveComponent)("ui-slug-group"),b=(0,r.resolveComponent)("ui-textarea-group"),v=(0,r.resolveComponent)("ui-checkbox-single"),C=(0,r.resolveComponent)("ui-fieldset"),y=(0,r.resolveComponent)("ui-radio"),N=(0,r.resolveComponent)("ui-radio-group"),x=(0,r.resolveComponent)("blueprint");return(0,r.openBlock)(),(0,r.createElementBlock)("div",null,[(0,r.createVNode)(d,{to:"actions"},{default:(0,r.withCtx)((function(){return[(0,r.createElementVNode)("div",n,[(0,r.createVNode)(s,{to:{name:"forms"},variant:"secondary"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Go Back")]}),void 0,!0),_:1}),(0,r.createVNode)(s,{type:"submit",onClick:(0,r.withModifiers)(l.handleSave,["prevent"]),variant:"primary",disabled:!o.form.hasChanges||o.loading},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Save")]}),void 0,!0),_:1},8,["onClick","disabled"])])]}),void 0,!0),_:1}),(0,r.withDirectives)((0,r.createVNode)(m,{title:"Loading..."},null,512),[[r.vShow,o.loading]]),(0,r.createVNode)(d,{to:"sidebar-right"},{default:(0,r.withCtx)((function(){return[(0,r.withDirectives)((0,r.createElementVNode)("div",null,[o.form?((0,r.openBlock)(),(0,r.createBlock)(_,{key:0,id:"collection-sidebar"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(u,{id:"collection_panel_status",tabindex:"-1"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(c,{name:"status",label:"Status",modelValue:o.form.status,"onUpdate:modelValue":t[0]||(t[0]=function(e){return o.form.status=e}),"true-value":!0,"false-value":!1},null,8,["modelValue"])]}),void 0,!0),_:1}),(0,r.createVNode)(u,null,{default:(0,r.withCtx)((function(){return[o.resource?((0,r.openBlock)(),(0,r.createBlock)(h,{key:0},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(p,{name:"Status"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(f,{icon:["fas","circle"],class:(0,r.normalizeClass)(["fa-fw text-xs",{"text-success-500":o.form.status,"text-danger-500":!o.form.status}])},null,8,["class"]),(0,r.createTextVNode)(" "+(0,r.toDisplayString)(o.form.status?"Enabled":"Disabled"),1)]}),void 0,!0),_:1}),(0,r.createVNode)(p,{name:"Created At"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)((0,r.toDisplayString)(e.$moment(o.resource.created_at).format("Y-MM-DD, hh:mm a")),1)]}),void 0,!0),_:1}),(0,r.createVNode)(p,{name:"Updated At"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)((0,r.toDisplayString)(e.$moment(o.resource.updated_at).format("Y-MM-DD, hh:mm a")),1)]}),void 0,!0),_:1})]}),void 0,!0),_:1})):(0,r.createCommentVNode)("",!0)]}),void 0,!0),_:1})]}),void 0,!0),_:1})):(0,r.createCommentVNode)("",!0)],512),[[r.vShow,!o.loading]])]}),void 0,!0),_:1}),(0,r.withDirectives)((0,r.createElementVNode)("div",null,[(0,r.createVNode)(m,{title:"General Information",description:"General information about this form and what it collects."},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(V,{name:"name",label:"Name",help:"What should this form be called?",autocomplete:"off",autofocus:"",required:"","has-error":o.form.errors.has("name"),"error-message":o.form.errors.get("name"),modelValue:o.form.name,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.form.name=e})},null,8,["has-error","error-message","modelValue"]),(0,r.createVNode)(g,{name:"form-handle",label:"Handle",autocomplete:"off",monospaced:"",required:"",delimiter:"_",watch:o.form.name,"has-error":o.form.errors.has("handle"),"error-message":o.form.errors.get("handle"),modelValue:o.form.handle,"onUpdate:modelValue":t[2]||(t[2]=function(e){return o.form.handle=e})},null,8,["watch","has-error","error-message","modelValue"]),(0,r.createVNode)(b,{name:"description",label:"Description",help:"Give a short description of what this form will collect.",autocomplete:"off","has-error":o.form.errors.has("description"),"error-message":o.form.errors.get("description"),modelValue:o.form.description,"onUpdate:modelValue":t[3]||(t[3]=function(e){return o.form.description=e})},null,8,["has-error","error-message","modelValue"])]}),void 0,!0),_:1}),(0,r.createVNode)(m,{title:"Privacy",description:"Configure this forms privacy settings."},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(C,{label:"Privacy Settings"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(v,{name:"collect_email_addresses",id:"collect_email_addresses",modelValue:o.form.collect_email_addresses,"onUpdate:modelValue":t[4]||(t[4]=function(e){return o.form.collect_email_addresses=e})},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Collect email addresses")]}),void 0,!0),_:1},8,["modelValue"]),(0,r.createVNode)(v,{name:"collect_ip_addresses",id:"collect_ip_addresses",modelValue:o.form.collect_ip_addresses,"onUpdate:modelValue":t[5]||(t[5]=function(e){return o.form.collect_ip_addresses=e})},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Collect IP addresses")]}),void 0,!0),_:1},8,["modelValue"]),(0,r.createVNode)(v,{name:"response_receipt",id:"response_receipt",help:"Respondents will receive a copy of their submission.",disabled:!o.form.collect_email_addresses,modelValue:o.form.response_receipt,"onUpdate:modelValue":t[6]||(t[6]=function(e){return o.form.response_receipt=e})},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Response receipts")]}),void 0,!0),_:1},8,["disabled","modelValue"])]}),void 0,!0),_:1})]}),void 0,!0),_:1}),(0,r.createVNode)(m,{title:"Spam",description:"Configure this forms spam protection settings."},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(C,{label:"Spam Settings"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(v,{name:"enable_recaptcha",id:"enable_recaptcha",help:"Be sure to enter your site key and secret key in settings.",modelValue:o.form.enable_recaptcha,"onUpdate:modelValue":t[7]||(t[7]=function(e){return o.form.enable_recaptcha=e})},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Enable Google reCAPTCHA")]}),void 0,!0),_:1},8,["modelValue"]),(0,r.createVNode)(v,{name:"enable_honeypot",id:"enable_honeypot",help:"A honeypot is a great and native alternative to Google reCAPTCHA. Both options can be safely enabled at the same time.",modelValue:o.form.enable_honeypot,"onUpdate:modelValue":t[8]||(t[8]=function(e){return o.form.enable_honeypot=e})},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Enable Honeypot")]}),void 0,!0),_:1},8,["modelValue"])]}),void 0,!0),_:1})]}),void 0,!0),_:1}),(0,r.createVNode)(m,{title:"Notifications",description:"Configure who should receive notifications when submissions are made."},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(b,{name:"send_to",label:"Send notifications to...",help:"List emails as a comma separated list.",placeholder:"marie.c@example.com, nikola.t@example.com","has-error":o.form.errors.has("send_to"),"error-message":o.form.errors.get("send_to"),modelValue:o.form.send_to,"onUpdate:modelValue":t[9]||(t[9]=function(e){return o.form.send_to=e})},null,8,["has-error","error-message","modelValue"]),(0,r.createVNode)(V,{name:"reply_to",label:"Reply to...",help:"Replies to the confirmation email will be sent to this e-mail. By default this will reference the default email in system settings.",autocomplete:"off","has-error":o.form.errors.has("reply_to"),"error-message":o.form.errors.get("reply_to"),modelValue:o.form.reply_to,"onUpdate:modelValue":t[10]||(t[10]=function(e){return o.form.reply_to=e})},null,8,["has-error","error-message","modelValue"])]}),void 0,!0),_:1}),(0,r.createVNode)(m,{title:"Confirmations",description:"Configure confirmation settings when submissions are made."},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(N,{inline:"",label:"After submitting the form...","has-error":o.form.errors.has("redirect_on_submission"),"error-message":o.form.errors.get("redirect_on_submission")},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(y,{id:"redirect_on_submission_false",modelValue:o.form.redirect_on_submission,"onUpdate:modelValue":t[11]||(t[11]=function(e){return o.form.redirect_on_submission=e}),name:"redirect_on_submission","native-value":!1},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Redirect to default confirmation page...")]}),void 0,!0),_:1},8,["modelValue"]),(0,r.createVNode)(y,{id:"redirect_on_submission_true",modelValue:o.form.redirect_on_submission,"onUpdate:modelValue":t[12]||(t[12]=function(e){return o.form.redirect_on_submission=e}),name:"redirect_on_submission","native-value":!0},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Redirect to custom page...")]}),void 0,!0),_:1},8,["modelValue"])]}),void 0,!0),_:1},8,["has-error","error-message"]),!1===o.form.redirect_on_submission?((0,r.openBlock)(),(0,r.createBlock)(V,{key:0,name:"confirmation_message",label:"Message",help:"This message will be displayed on the confirmation page.",autocomplete:"off","has-error":o.form.errors.has("confirmation_message"),"error-message":o.form.errors.get("confirmation_message"),placeholder:"Thank you! We'll be in touch soon.",modelValue:o.form.confirmation_message,"onUpdate:modelValue":t[13]||(t[13]=function(e){return o.form.confirmation_message=e})},null,8,["has-error","error-message","modelValue"])):(0,r.createCommentVNode)("",!0),!0===o.form.redirect_on_submission?((0,r.openBlock)(),(0,r.createBlock)(V,{key:1,name:"redirect_url",label:"URL",help:"The URL to redirect users to after submitting the form.",autocomplete:"off","has-error":o.form.errors.has("redirect_url"),"error-message":o.form.errors.get("redirect_url"),modelValue:o.form.redirect_url,"onUpdate:modelValue":t[14]||(t[14]=function(e){return o.form.redirect_url=e})},null,8,["has-error","error-message","modelValue"])):(0,r.createCommentVNode)("",!0)]}),void 0,!0),_:1}),(0,r.createVNode)(m,{title:"Templates",description:"Configure this forms template settings."},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(V,{name:"form_template",label:"Form Template",help:"What template is responsible for rendering this form?",autocomplete:"off",monospaced:"","has-error":o.form.errors.has("form_template"),"error-message":o.form.errors.get("form_template"),modelValue:o.form.form_template,"onUpdate:modelValue":t[15]||(t[15]=function(e){return o.form.form_template=e})},null,8,["has-error","error-message","modelValue"]),(0,r.createVNode)(V,{name:"thankyou_template",label:"Thank You Template",help:"What template is reponsible for thanking respondents?",autocomplete:"off",monospaced:"","has-error":o.form.errors.has("thankyou_template"),"error-message":o.form.errors.get("thankyou_template"),modelValue:o.form.thankyou_template,"onUpdate:modelValue":t[16]||(t[16]=function(e){return o.form.thankyou_template=e})},null,8,["has-error","error-message","modelValue"])]}),void 0,!0),_:1}),(0,r.createVNode)(m,{id:"form_panel_blueprint",grid:!1,title:"Blueprint",description:"Create the content blueprint for this form by adding panel sections and fields to either the page body or page sidebar.",tabindex:"-1"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(x,{placements:i.placements,form:o.form},null,8,["placements","form"])]}),void 0,!0),_:1})],512),[[r.vShow,!o.loading]])])}]])}}]);