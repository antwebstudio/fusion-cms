"use strict";(self.webpackChunkfusioncms=self.webpackChunkfusioncms||[]).push([[6491],{1381:(e,t,r)=>{r.d(t,{Z:()=>o});const o={methods:{isAssignable:function(e,t){return!_.includes(["guest"],e)&&this.$level(t)},isRemovable:function(e,t){return!_.includes(["owner","user","guest"],e)&&this.$level(t)},hasPermissions:function(e){return!_.includes(["owner"],e)}}}},6491:(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});const o={auth:function(){return{permission:"roles.viewAny"}},head:{title:function(){return{inner:"Roles"}}},mixins:[r(1381).Z],data:function(){return{transfer:"",roles:[]}},methods:{roleOptions:function(e){var t=_.reject(this.roles,(function(t){return e==t.handle}));return _.map(t,(function(e){return{label:e.name,value:e.handle}}))},destroy:function(e){var t=this;axios.delete("/api/roles/".concat(e),{data:{transfer:this.transfer}}).then((function(e){t.transfer="",toast("Role successfully deleted.","success"),bus().$emit("refresh-datatable-roles"),axios.get("/api/roles").then((function(e){t.roles=e.data.data})).catch((function(e){toast(e.message,"failed")}))})).catch((function(e){toast(e.message,"failed")}))},isOwner:function(e){return e&&1===e}},created:function(){var e=this;bus().$on("modal-opened",(function(t){"delete-role"==t&&(e.transfer="")}))},beforeRouteEnter:function(e,t,r){axios.get("/api/roles").then((function(e){r((function(t){return t.roles=e.data.data}))})).catch((function(e){r((function(e){e.$router.push("/roles"),toast(error.toString(),"danger")}))}))}},n=o;const a=(0,r(1900).Z)(n,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"roles-page"},[t("portal",{attrs:{to:"title"}},[t("page-title",{attrs:{icon:"user-shield"}},[e._v("Roles")])],1),e._v(" "),t("portal",{attrs:{to:"actions"}},[e.$can("roles.create")?t("ui-button",{key:"create-role-btn",attrs:{to:{name:"roles.create"},variant:"primary"}},[e._v("Create Role")]):e._e()],1),e._v(" "),t("ui-card",[t("ui-card-body",[t("ui-table",{key:"roles",staticClass:"roles-table",attrs:{id:"roles",endpoint:"/datatable/roles","sort-by":"order","show-page-status":"","show-page-numbers":"","show-page-nav":"","show-page-ends":"",link_name:"roles.edit",link_param:"role",reorder_route:"/api/roles/reorder",show_status:!1},scopedSlots:e._u([{key:"name",fn:function(r){return[e.$can("roles.view")?t("router-link",{attrs:{to:{name:"roles.show",params:{role:r.record.id}}}},[e._v(e._s(r.record.name))]):t("span",[e._v(e._s(r.record.name))])]}},{key:"level",fn:function(r){return[t("ui-badge",[e._v(e._s(r.record.level))])]}},{key:"description",fn:function(r){return[t("span",{staticClass:"text-gray-800 text-sm"},[e._v(e._s(r.record.description))])]}},{key:"actions",fn:function(r){return[t("ui-actions",{key:"role_"+r.record.id+"_actions",attrs:{id:"role_"+r.record.id+"_actions"}},[e.$can("roles.view")?t("ui-dropdown-link",{attrs:{to:{name:"roles.show",params:{role:r.record.id}}}},[e._v("\n                            View\n                        ")]):e._e(),e._v(" "),!e.isOwner(r.record.id)&&e.$can("roles.update",r.record.level)?t("ui-dropdown-link",{attrs:{to:{name:"roles.edit",params:{role:r.record.id}}},on:{click:function(e){e.preventDefault()}}},[e._v("\n                            Edit\n                        ")]):e._e(),e._v(" "),e.isRemovable(r.record.handle)&&e.$can("roles.delete",r.record.level)?t("ui-dropdown-divider"):e._e(),e._v(" "),e.isRemovable(r.record.handle)&&e.$can("roles.delete",r.record.level)?t("ui-dropdown-link",{directives:[{name:"modal",rawName:"v-modal:delete-role",value:r.record,expression:"table.record",arg:"delete-role"}],staticClass:"danger",on:{click:function(e){e.preventDefault()}}},[e._v("\n                            Delete\n                        ")]):e._e()],1)]}}])})],1)],1),e._v(" "),t("portal",{attrs:{to:"modals"}},[t("ui-modal",{attrs:{name:"delete-role",title:"Delete Role"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("p",[e._v("Please select another role to move users to.")]),e._v(" "),r.data?t("ui-select-group",{attrs:{id:"move-role",name:"move_role",label:"Transfer to Role",options:e.roleOptions(r.data.handle),autocomplete:"off"},model:{value:e.transfer,callback:function(t){e.transfer=t},expression:"transfer"}}):e._e()]}},{key:"footer",fn:function(r){return[t("ui-button",{directives:[{name:"modal",rawName:"v-modal:delete-role",arg:"delete-role"}],staticClass:"ml-3",attrs:{variant:"danger",disabled:0==e.transfer.length},on:{click:function(t){return e.destroy(r.data.id)}}},[e._v("Delete")]),e._v(" "),t("ui-button",{directives:[{name:"modal",rawName:"v-modal:delete-role",arg:"delete-role"}],attrs:{variant:"secondary"}},[e._v("Cancel")])]}}])})],1)],1)}),[],!1,null,null,null).exports}}]);