"use strict";(self.webpackChunkfusioncms=self.webpackChunkfusioncms||[]).push([[8993],{1381:(e,o,t)=>{t.d(o,{Z:()=>r});const r={methods:{isAssignable:function(e,o){return!_.includes(["guest"],e)&&this.$level(o)},isRemovable:function(e,o){return!_.includes(["owner","user","guest"],e)&&this.$level(o)},hasPermissions:function(e){return!_.includes(["owner"],e)}}}},8993:(e,o,t)=>{t.r(o),t.d(o,{default:()=>a,getRole:()=>s});var r=t(3802),n={class:"roles-page"};var i=t(8401);const l={auth:function(){return{permission:"roles.update",level:this.getAuthLevel()}},head:{title:function(){return{inner:this.role.name||"Loading..."}}},data:function(){return{role:{},form:new i.Z,loading:!1}},components:{"shared-form":t(4955).Z},methods:{submit:function(){var e=this;this.loading=!0,this.form.patch("/api/roles/".concat(this.role.id)).then((function(o){toast("Role successfully updated","success"),e.$router.push("/roles")})).catch((function(o){toast(o.message,"failed"),e.loading=!1}))},getAuthLevel:function(){return!!this.role.level&&this.role.level}},beforeRouteEnter:function(e,o,t){s(e.params.role,(function(e,o,r){t(e?function(o){o.$router.push("/roles"),toast(e.toString(),"danger")}:function(e){e.role=o,e.form=new i.Z(r,!0),emitter.emit("updateHead"),emitter.emit("updateAuth")})}))}};function s(e,o){axios.get("/api/roles/"+e).then((function(e){var t=e.data.data,r={name:t.name,description:t.description,level:t.level,permissions:t.permissions};o(null,t,r)})).catch((function(e){o(new Error("The requested role could not be found"))}))}const a=(0,t(3744).Z)(l,[["render",function(e,o,t,i,l,s){var a=(0,r.resolveComponent)("page-title"),u=(0,r.resolveComponent)("portal"),c=(0,r.resolveComponent)("shared-form");return(0,r.openBlock)(),(0,r.createElementBlock)("div",n,[(0,r.createVNode)(u,{to:"title"},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(a,{icon:"user-shield"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Edit Role")]}),void 0,!0),_:1})]}),void 0,!0),_:1}),(0,r.createVNode)(c,{loading:l.loading,form:l.form,role:l.role,submit:s.submit},null,8,["loading","form","role","submit"])])}]])},4955:(e,o,t)=>{t.d(o,{Z:()=>a});var r=t(3802),n={class:"buttons"},i=(0,r.createElementVNode)("p",null,"Owner role information and permissions are not editable.",-1),l={key:0};const s={mixins:[t(1381).Z],props:{role:{type:Object,required:!1},form:{type:Object,required:!0},submit:{required:!0},loading:{type:Boolean,required:!1}},computed:{levelHelp:function(){return this.disableSetLevel?"You can not edit your own role's level.":"Enter a number between "+this.$user.role.level+" and 99."},disableSetLevel:function(){return!!this.role&&this.role.id===this.$user.role.id},permissions:{get:function(){return this.form.permissions},set:function(e){this.form.permissions=e}},isOwner:function(){return!!this.role&&(this.role.id&&1===this.role.id)}},methods:{}};const a=(0,t(3744).Z)(s,[["render",function(e,o,t,s,a,u){var c=(0,r.resolveComponent)("ui-button"),d=(0,r.resolveComponent)("portal"),m=(0,r.resolveComponent)("section-card"),f=(0,r.resolveComponent)("ui-alert"),p=(0,r.resolveComponent)("ui-input-group"),h=(0,r.resolveComponent)("ui-textarea-group"),v=(0,r.resolveComponent)("ui-checkbox"),b=(0,r.resolveComponent)("ui-table");return(0,r.openBlock)(),(0,r.createElementBlock)("div",null,[(0,r.createVNode)(d,{to:"actions"},{default:(0,r.withCtx)((function(){return[(0,r.createElementVNode)("div",n,["sm"!=e.$mq?((0,r.openBlock)(),(0,r.createBlock)(c,{key:"go-back-btn",to:{name:"roles"},variant:"secondary"},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Go Back")]}),void 0,!0),_:1})):(0,r.createCommentVNode)("",!0),u.isOwner?(0,r.createCommentVNode)("",!0):((0,r.openBlock)(),(0,r.createBlock)(c,{key:"save-btn",type:"submit",onClick:(0,r.withModifiers)(t.submit,["prevent"]),variant:"primary",disabled:!t.form.hasChanges||t.loading},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)("Save")]}),void 0,!0),_:1},8,["onClick","disabled"]))])]}),void 0,!0),_:1}),(0,r.withDirectives)((0,r.createVNode)(m,{title:"Loading..."},null,512),[[r.vShow,t.loading]]),(0,r.createTextVNode)(),(0,r.withDirectives)((0,r.createElementVNode)("div",null,[u.isOwner?((0,r.openBlock)(),(0,r.createBlock)(f,{key:0,icon:"info-circle",variant:"info"},{default:(0,r.withCtx)((function(){return[i]}),void 0,!0),_:1})):(0,r.createCommentVNode)("",!0),(0,r.createVNode)(m,{title:"General Information",description:"General information about this role and what it can manage."},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(p,{id:"roles-name",name:"name",label:"Name",description:"What should this role be called?",autocomplete:"off",autofocus:"",required:"","has-error":t.form.errors.has("name"),"error-message":t.form.errors.get("name"),modelValue:t.form.name,"onUpdate:modelValue":o[0]||(o[0]=function(e){return t.form.name=e}),readonly:u.isOwner},null,8,["has-error","error-message","modelValue","readonly"]),(0,r.createVNode)(h,{id:"roles-description",name:"description",label:"Description",autocomplete:"off","has-error":t.form.errors.has("description"),"error-message":t.form.errors.get("description"),modelValue:t.form.description,"onUpdate:modelValue":o[1]||(o[1]=function(e){return t.form.description=e}),readonly:u.isOwner,rows:2},null,8,["has-error","error-message","modelValue","readonly"])]}),void 0,!0),_:1}),(0,r.createVNode)(m,{title:"Access Control",description:"Roles may manage other roles and their associated users with a level equal to or greater than their own. Owners have an ACL of 0."},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(p,{name:"level",label:"Level",modelValue:t.form.level,"onUpdate:modelValue":o[2]||(o[2]=function(e){return t.form.level=e}),disabled:u.disableSetLevel,help:u.levelHelp},null,8,["modelValue","disabled","help"])]}),void 0,!0),_:1}),e.hasPermissions(t.form.name)?((0,r.openBlock)(),(0,r.createBlock)(m,{key:1,title:"Permissions",description:"Permissions allow you to restrict which areas of the controle panel this user can access."},{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(b,{key:"permissions-table",ref:"permissions",id:"permissions-table",endpoint:"/datatable/permissions","sort-by":"name","no-actions":"","show-page-status":""},{name:(0,r.withCtx)((function(e){return[u.isOwner?((0,r.openBlock)(),(0,r.createElementBlock)("code",l,(0,r.toDisplayString)(e.record.name),1)):((0,r.openBlock)(),(0,r.createBlock)(v,{key:1,id:"roles-checkbox-"+e.record.name,name:"permissions","native-value":e.record.name,modelValue:u.permissions,"onUpdate:modelValue":o[3]||(o[3]=function(e){return u.permissions=e})},{default:(0,r.withCtx)((function(){return[(0,r.createElementVNode)("code",null,(0,r.toDisplayString)(e.record.name),1)]}),void 0,!0),_:2},1032,["id","native-value","modelValue"]))]})),description:(0,r.withCtx)((function(e){return[(0,r.createElementVNode)("p",null,(0,r.toDisplayString)(e.record.description),1)]})),_:1},512)]}),void 0,!0),_:1})):(0,r.createCommentVNode)("",!0)],512),[[r.vShow,!t.loading]])])}]])}}]);