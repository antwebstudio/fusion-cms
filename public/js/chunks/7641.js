"use strict";(self.webpackChunkfusioncms=self.webpackChunkfusioncms||[]).push([[7641],{5320:(t,a,e)=>{e.d(a,{Z:()=>o});const o={methods:{downloadBackup:function(t){window.open("/backups/".concat(t),"_blank")},runBackup:function(){axios.post("/api/backups").then((function(t){return toast("Backup request added to queue!","success")})).catch((function(t){return toast(t.response.data.message,"failed")}))},destroyBackup:function(t){var a=this;axios.delete("/api/backups/".concat(t)).then((function(t){toast("Backp successfully deleted!","success"),a.$router.push("/backups")}))}}}},7641:(t,a,e)=>{e.r(a),e.d(a,{default:()=>n});const o={head:{title:function(){return{inner:"Backups"}}},mixins:[e(5320).Z,e(8273).Z],data:function(){return{endpoint:"/datatable/backups"}},methods:{upload:function(t){var a=this;if(void 0!==t){var e=new FormData;e.append("_method","POST"),e.append("file-upload",t),axios.post("/api/backups/upload",e).then((function(){toast("Backup successfully uploaded!","success"),a.$refs.upload.remove(),bus().$emit("refresh-datatable-backups")}))}}}};const n=(0,e(1900).Z)(o,(function(){var t=this,a=t._self._c;return a("div",{staticClass:"backups-page"},[a("portal",{attrs:{to:"title"}},[a("page-title",{attrs:{icon:"save"}},[t._v("Backups")])],1),t._v(" "),a("portal",{attrs:{to:"actions"}},[a("div",{staticClass:"buttons"},[a("ui-button",{directives:[{name:"modal",rawName:"v-modal:upload-backup",arg:"upload-backup"}],staticClass:"mr-1"},[t._v("Upload")]),t._v(" "),a("ui-button",{directives:[{name:"modal",rawName:"v-modal:confirm-backup",arg:"confirm-backup"}],attrs:{variant:"primary"},on:{click:function(t){t.preventDefault()}}},[t._v("Backup Now")])],1)]),t._v(" "),a("ui-card",[a("ui-card-body",[a("ui-table",{key:"backups",staticClass:"backup-table",attrs:{refresh:5e3,id:"backups",endpoint:t.endpoint,"sort-by":"name","sort-in":"desc","per-page":50},scopedSlots:t._u([{key:"name",fn:function(e){return[a("ui-status",{staticClass:"mr-2",attrs:{value:"success"==e.record.state}}),t._v(" "),a("router-link",{attrs:{to:{name:"backups.show",params:{backup:e.record.id}}}},[t._v(t._s(e.record.name))])]}},{key:"size",fn:function(e){return[a("code",[t._v(t._s(t.filesize(e.record.size)))])]}},{key:"created_at",fn:function(a){return[t._v("\n                        "+t._s(t.$moment(a.record.created_at).fromNow())+"\n                    ")]}},{key:"actions",fn:function(e){return[a("ui-actions",{key:"backup_"+e.record.id+"_actions",attrs:{id:"backup_"+e.record.id+"_actions"}},[t.$can("backups.view")?a("ui-dropdown-link",{attrs:{to:{name:"backups.show",params:{backup:e.record.id}}}},[t._v("\n\t\t\t\t\t\t\t\tView\n\t\t\t\t\t\t\t")]):t._e(),t._v(" "),a("ui-dropdown-divider"),t._v(" "),t.$can("backups.restore")?a("ui-dropdown-link",{directives:[{name:"modal",rawName:"v-modal:restore-backup",value:e.record,expression:"table.record",arg:"restore-backup"}],on:{click:function(t){t.preventDefault()}}},[t._v("\n\t\t\t\t\t\t\t\tRestore\n\t\t\t\t\t\t\t")]):t._e(),t._v(" "),a("ui-dropdown-link",{on:{click:function(a){return a.preventDefault(),t.downloadBackup(e.record.id)}}},[t._v("\n\t\t\t\t\t\t\t\tDownload\n\t\t\t\t\t\t\t")]),t._v(" "),!e.record.isLatest&&t.$can("backups.delete")?a("ui-dropdown-link",{directives:[{name:"modal",rawName:"v-modal:delete-backup",value:e.record,expression:"table.record",arg:"delete-backup"}],on:{click:function(t){t.preventDefault()}}},[t._v("\n\t\t\t\t\t\t\t\tDelete\n\t\t\t\t\t\t\t")]):t._e()],1)]}}])})],1)],1),t._v(" "),a("portal",{attrs:{to:"modals"}},[a("restore-backup-modal"),t._v(" "),a("ui-modal",{key:"confirm_backup",attrs:{name:"confirm-backup",title:"Backup Now"}},[a("p",[t._v("This will perform a full backup of your website. Backups can take up to one minute per GB of data.")]),t._v(" "),a("template",{slot:"footer"},[a("ui-button",{directives:[{name:"modal",rawName:"v-modal:confirm-backup",arg:"confirm-backup"}],staticClass:"ml-3",attrs:{variant:"primary"},on:{click:function(a){return t.runBackup()}}},[t._v("Backup")]),t._v(" "),a("ui-button",{directives:[{name:"modal",rawName:"v-modal:confirm-backup",arg:"confirm-backup"}]},[t._v("Cancel")])],1)],2),t._v(" "),a("ui-modal",{key:"delete_backup",attrs:{name:"delete-backup",title:"Delete Backup"},scopedSlots:t._u([{key:"footer",fn:function(e){return[a("ui-button",{directives:[{name:"modal",rawName:"v-modal:delete-backup",arg:"delete-backup"}],staticClass:"ml-3",attrs:{variant:"danger"},on:{click:function(a){return t.destroyBackup(e.data.id)}}},[t._v("Delete")]),t._v(" "),a("ui-button",{directives:[{name:"modal",rawName:"v-modal:delete-backup",arg:"delete-backup"}]},[t._v("Cancel")])]}}])},[a("p",[t._v("Are you sure you want to permenantly delete this backup?")])]),t._v(" "),a("ui-modal",{key:"upload_backup",attrs:{name:"upload-backup",title:"Upload Backup"}},[a("ui-upload",{ref:"upload",attrs:{name:"file-upload",label:"Upload",accept:"zip",multiple:!1},on:{input:t.upload}})],1)],1)],1)}),[],!1,null,null,null).exports}}]);