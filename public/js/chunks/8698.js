"use strict";(self.webpackChunkfusioncms=self.webpackChunkfusioncms||[]).push([[8698],{2945:(e,t,o)=>{o.d(t,{Z:()=>n});const n={props:{field:{type:Object,required:!0},value:{required:!1,default:null},errors:{type:Object,required:!1,default:function(){}}},computed:{model:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},methods:{hasError:function(e){return this.errors&&this.errors.has(e)},errorMessage:function(e){return this.hasError(e)?this.errors.get(e):""}}}},8698:(e,t,o)=>{o.r(t),o.d(t,{default:()=>Y});var n=o(3802),r=(0,n.createElementVNode)("span",null,"Manage Asset Selection",-1),i={class:"side-container"},l={class:"content-container"},c={class:"card"},a={class:"card__body"},s={class:"toolbar"},d={class:"toolbar__group"},u={class:"buttons"},f={class:"buttons__group"},m={class:"toolbar__group toolbar__group--grow"},p={class:"toolbar__group"},h={class:"flex items-center border-b border-gray-200 px-3 py-2"},v={class:"gallery-container selectables"},b={key:0,class:"gallery border-b border-gray-200 pb-2"},y={class:"gallery"};var g=o(3907),k=o(2945),V=o(9109),N=o(3771),C=o(5579),w={class:"card h-full"},E={key:0,class:"flex items-center justify-between border-b border-gray-200 p-3"},B={key:1},x={class:"w-full p-3"},O={class:"flex items-center py-2"},j={class:"w-1/12"},D={class:"w-3/12"},S={class:"w-6/12"},Z={class:"w-2/12 text-right"},A={key:0,class:"text-sm italic text-danger-600 text-center"},L={key:2,class:"h-full flex flex-col justify-center items-center text-5xl text-gray-300"},q=(0,n.createElementVNode)("span",{class:"text-lg py-2 text-gray-500"},"Select some files...",-1);const P={computed:{selection:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},addLimit:function(){return this.limit-this.selection.length}},props:{value:{type:Array,required:!0},limit:{type:Number,default:1/0},hasHeader:{type:Boolean,default:!0}},methods:{remove:function(e){this.selection=_.reject(this.selection,(function(t){return t.id==e}))}}};var M=o(3744);const $=(0,M.Z)(P,[["render",function(e,t,o,r,i,l){var c=(0,n.resolveComponent)("fa-icon"),a=(0,n.resolveComponent)("ui-button"),s=(0,n.resolveComponent)("ui-sortable-handle"),d=(0,n.resolveComponent)("ui-img"),u=(0,n.resolveComponent)("ui-sortable-item"),f=(0,n.resolveComponent)("ui-sortable-list");return(0,n.openBlock)(),(0,n.createElementBlock)("div",w,[o.hasHeader?((0,n.openBlock)(),(0,n.createElementBlock)("div",E,[(0,n.createVNode)(a,{onClick:t[0]||(t[0]=function(t){return e.$emit("reject")}),variant:"warning"},{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(c,{icon:["fas","times"],class:"mr-2"}),(0,n.createTextVNode)(" Reject")]}),void 0,!0),_:1}),(0,n.createVNode)(a,{onClick:t[1]||(t[1]=function(t){return e.$emit("accept")}),variant:"info"},{default:(0,n.withCtx)((function(){return[(0,n.createTextVNode)("Accept "),(0,n.createVNode)(c,{icon:["fas","check"],class:"ml-2"})]}),void 0,!0),_:1})])):(0,n.createCommentVNode)("",!0),l.selection.length>0?((0,n.openBlock)(),(0,n.createElementBlock)("div",B,[(0,n.createVNode)(f,{modelValue:l.selection,"onUpdate:modelValue":t[2]||(t[2]=function(e){return l.selection=e}),class:"sortable-list"},{default:(0,n.withCtx)((function(){return[(0,n.createElementVNode)("div",x,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(l.selection,(function(e){return(0,n.openBlock)(),(0,n.createBlock)(u,{key:e.id},{default:(0,n.withCtx)((function(){return[(0,n.createElementVNode)("div",O,[(0,n.createElementVNode)("div",j,[(0,n.createVNode)(s,{class:"cursor-move"},{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(c,{icon:"ellipsis-v",class:"handle fa-fw text-gray-400"})]}),void 0,!0),_:1})]),(0,n.createElementVNode)("div",D,["image"==e.type?((0,n.openBlock)(),(0,n.createBlock)(d,{key:0,src:e.url+"?w=50&h=50&fit=crop","background-color":"white",width:50,height:50},null,8,["src"])):((0,n.openBlock)(),(0,n.createBlock)(d,{key:1,src:"/vendor/fusion/img/"+e.type+"-large.svg","background-color":"white",width:50,height:50},null,8,["src"]))]),(0,n.createElementVNode)("div",S,[(0,n.createElementVNode)("div",null,(0,n.toDisplayString)(e.name),1)]),(0,n.createElementVNode)("div",Z,[(0,n.createVNode)(a,{onClick:function(t){return l.remove(e.id)},theme:"danger"},{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(c,{icon:["fas","trash"]})]}),void 0,!0),_:2},1032,["onClick"])])])]}),void 0,!0),_:2},1024)})),128))])]}),void 0,!0),_:1},8,["modelValue"]),l.addLimit<=0?((0,n.openBlock)(),(0,n.createElementBlock)("div",A," File limit reached ")):(0,n.createCommentVNode)("",!0)])):((0,n.openBlock)(),(0,n.createElementBlock)("div",L,[(0,n.createVNode)(c,{icon:["far","copy"],class:"fa-fw fa-3x"}),q]))])}]]);var R=o(4079),F=o(2893),I=o(6979),U=o(1914),z=o(5727),T=o(1825),H=o(7309);function G(e){return function(e){if(Array.isArray(e))return J(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return J(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return J(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function K(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Q(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?K(Object(o),!0).forEach((function(t){W(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):K(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function W(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const X={name:"asset-fieldtype",mixins:[k.Z,V.Z,N.Z],components:{"file-uploader":C.Z,"file-selection":$,"breadcrumb-action":R.Z,"display-action":F.Z,"search-action":I.Z,"sort-action":U.Z,"view-action":z.Z,directory:T.Z,file:H.Z},data:function(){return{requestOpen:!1,modalOpen:!1,selection:[]}},watch:{loading:function(e){var t=this;this.$nextTick((function(){e?t.destroySelector():(t.loadSelector(t.$el.querySelector(".selectables")),t.requestOpen&&(t.modalOpen=!0,t.requestOpen=!1))}))}},computed:{uploadsEnabled:function(){return this.field.settings.allow_uploads},navigationEnabled:function(){return this.field.settings.allow_navigation},selectionLimit:function(){return Number(this.field.settings.limit)||1/0},addLimit:function(){return this.selectionLimit-this.selection.length},typeRestriction:function(){return this.field.settings.filetype_restrictions}},methods:Q(Q({},(0,g.nv)({setDropzoneVisible:"filemanager/setDropzoneVisible"})),{},{isValidSelection:function(e){return 0==this.typeRestriction.length||_.includes(this.typeRestriction,e.type)},push:function(){var e=this;_.forEach(this.selectedFiles,(function(t){return e.add(t)}))},add:function(e){if(this.addLimit>0){var t=_.find(this.selection,["id",e]),o=_.find(this.files,["id",e]);!t&&this.isValidSelection(o)&&this.selection.push(o)}},open:function(){this.reset(),this.setCurrentDirectory(this.field.settings.directory||0),this.setRootDirectory(this.field.settings.directory||0),this.fetchDisk(this.field.settings.disk),this.selection=G(this.model),this.requestOpen=!0},close:function(){this.reset(),this.selection=[],this.modalOpen=!1},reject:function(){this.close()},accept:function(){this.model=G(this.selection),this.close()}}),created:function(){_.isEmpty(this.value)&&(this.model=[])},beforeDestroy:function(){this.reset()}},Y=(0,M.Z)(X,[["render",function(e,t,o,g,k,V){var N=(0,n.resolveComponent)("fa-icon"),C=(0,n.resolveComponent)("ui-button"),w=(0,n.resolveComponent)("file-selection"),E=(0,n.resolveComponent)("ui-field-group"),B=(0,n.resolveComponent)("file-uploader"),x=(0,n.resolveComponent)("search-action"),_=(0,n.resolveComponent)("display-action"),O=(0,n.resolveComponent)("sort-action"),j=(0,n.resolveComponent)("view-action"),D=(0,n.resolveComponent)("breadcrumb-action"),S=(0,n.resolveComponent)("directory"),Z=(0,n.resolveComponent)("file"),A=(0,n.resolveComponent)("ui-modal"),L=(0,n.resolveComponent)("new-folder-modal"),q=(0,n.resolveComponent)("portal"),P=(0,n.resolveDirective)("modal");return(0,n.openBlock)(),(0,n.createElementBlock)("div",null,[(0,n.createVNode)(E,{name:e.field.handle,fieldId:"".concat(e.field.handle,"-field"),label:e.field.name,help:e.field.help,hasError:e.hasError(e.field.handle),errorMessage:e.errorMessage(e.field.handle)},{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(C,{disabled:k.requestOpen,onClick:V.open},{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(N,{icon:["fas","tasks"],class:"mr-1"}),r]}),void 0,!0),_:1},8,["disabled","onClick"]),(0,n.createVNode)(w,{limit:V.selectionLimit,hasHeader:!1,modelValue:e.model,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.model=t})},null,8,["limit","modelValue"])]}),void 0,!0),_:1},8,["name","fieldId","label","help","hasError","errorMessage"]),(0,n.createVNode)(A,{name:"file-manager","no-header":"","no-footer":"","extra-large":"",modelValue:k.modalOpen,"onUpdate:modelValue":t[4]||(t[4]=function(e){return k.modalOpen=e})},{default:(0,n.withCtx)((function(){return[V.uploadsEnabled?((0,n.openBlock)(),(0,n.createBlock)(B,{key:0,ref:"uploader"},null,512)):(0,n.createCommentVNode)("",!0),(0,n.createElementVNode)("div",{class:"row",onDragenter:t[3]||(t[3]=function(t){return e.setDropzoneVisible(!0)})},[(0,n.createElementVNode)("div",i,[(0,n.createVNode)(w,{limit:V.selectionLimit,onReject:V.reject,onAccept:V.accept,modelValue:k.selection,"onUpdate:modelValue":t[1]||(t[1]=function(e){return k.selection=e})},null,8,["limit","onReject","onAccept","modelValue"])]),(0,n.createElementVNode)("div",l,[(0,n.createElementVNode)("div",c,[(0,n.createElementVNode)("div",a,[(0,n.createElementVNode)("div",s,[(0,n.createElementVNode)("div",d,[(0,n.createElementVNode)("div",u,[(0,n.createElementVNode)("div",f,[(0,n.createVNode)(C,{icon:"",onClick:(0,n.withModifiers)(V.push,["prevent"])},{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(N,{class:"icon",icon:"arrow-alt-circle-left"})]}),void 0,!0),_:1},8,["onClick"]),V.uploadsEnabled?((0,n.openBlock)(),(0,n.createBlock)(C,{key:0,icon:"",onClick:t[2]||(t[2]=(0,n.withModifiers)((function(t){return e.$refs.uploader.openDZ()}),["prevent"]))},{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(N,{class:"icon",icon:["fas","upload"]})]}),void 0,!0),_:1})):(0,n.createCommentVNode)("",!0),V.navigationEnabled?(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createBlock)(C,{key:1,icon:""},{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(N,{class:"icon",icon:["fas","folder-plus"]})]}),void 0,!0),_:1})),[[P,void 0,"new-folder"]]):(0,n.createCommentVNode)("",!0)])])]),(0,n.createElementVNode)("div",m,[(0,n.createVNode)(x)]),(0,n.createElementVNode)("div",p,[(0,n.createVNode)(_),(0,n.createVNode)(O),(0,n.createVNode)(j)])])]),(0,n.createElementVNode)("div",h,[V.navigationEnabled?((0,n.openBlock)(),(0,n.createBlock)(D,{key:0})):(0,n.createCommentVNode)("",!0)]),(0,n.createElementVNode)("div",v,[V.navigationEnabled?((0,n.openBlock)(),(0,n.createElementBlock)("div",b,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.directories,(function(t){return(0,n.openBlock)(),(0,n.createBlock)(S,{key:t.id,directory:t,isDropzone:!0,onDblclick:function(o){return e.navigate(t)}},null,8,["directory","onDblclick"])})),128))])):(0,n.createCommentVNode)("",!0),(0,n.createElementVNode)("div",y,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.files,(function(e){return(0,n.openBlock)(),(0,n.createBlock)(Z,{key:e.id,file:e,onDblclick:function(t){return V.add(e.id)}},null,8,["file","onDblclick"])})),128))])])])])],32)]}),void 0,!0),_:1},8,["modelValue"]),(0,n.createVNode)(q,{to:"modals"},{default:(0,n.withCtx)((function(){return[(0,n.createVNode)(L)]}),void 0,!0),_:1})])}]])}}]);