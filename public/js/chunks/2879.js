"use strict";(self.webpackChunkfusioncms=self.webpackChunkfusioncms||[]).push([[2879],{2879:(t,e,a)=>{a.r(e),a.d(e,{default:()=>o});const s={head:{title:function(){return{inner:"Theme"}}},data:function(){return{themes:[],confirmModal:!1,uploadForm:null}},methods:{setAsActive:function(t){var e=this;axios.patch("/api/theme/".concat(t)).then((function(){_.each(e.themes,(function(e){e.active=e.namespace===t})),toast("Active theme has been set","success")}))},refresh:function(){axios.all([axios.get("/api/themes")]).then(axios.spread(function(t){this.themes=t.data.data,this.uploadForm=null,this.confirmModal=!1}.bind(this)))},submitUpload:function(){var t=this;axios.post("/api/themes",this.uploadForm).then((function(e){toast("Theme successfully uploaded!","success"),t.confirmModal=!1,t.$refs.upload.remove(),t.refresh()}))},confirmUpload:function(){this.confirmModal=!0},cancelUpload:function(){this.confirmModal=!1,this.$refs.upload.remove()},verifyUpload:function(t){var e=this;void 0!==t&&(this.uploadForm=new FormData,this.uploadForm.append("_method","POST"),this.uploadForm.append("file-upload",t),axios.post("/api/themes/verify",this.uploadForm).then((function(t){e.submitUpload()})).catch((function(t){"A Theme with matching name already exists."==t.response.data.errors["file-upload"][0]?e.confirmUpload():(toast(t.response.data.message,"failed"),e.$refs.upload.remove(),e.$refs.upload.setError(t.response.data.errors["file-upload"][0]))})))}},beforeRouteEnter:function(t,e,a){a((function(t){t.refresh()}))}};const o=(0,a(1900).Z)(s,(function(){var t=this,e=t._self._c;return e("div",[e("portal",{attrs:{to:"title"}},[e("page-title",{attrs:{icon:"palette"}},[t._v("Theme")])],1),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"content-container"},[e("ui-upload",{ref:"upload",attrs:{name:"file-upload",label:"Upload",accept:"zip",multiple:!1},on:{input:t.verifyUpload}})],1)]),t._v(" "),e("div",{staticClass:"row"},t._l(t.themes,(function(a){return e("div",{key:a.name,staticClass:"col mb-6 md:w-1/2 xl:w-1/4"},[e("div",{staticClass:"card"},[e("img",{staticClass:"w-full rounded-t shadow",attrs:{src:a.preview,alt:a.name}}),t._v(" "),e("div",{staticClass:"card__body"},[e("div",{staticClass:"font-bold text-xl mb-2"},[t._v(t._s(a.name))]),t._v(" "),e("p",{staticClass:"text-gray-800 text-base"},[t._v(t._s(a.description))]),t._v(" "),e("div",{staticClass:"w-full border-t-2 border-gray-200 pt-3"},[a.active?e("p",{staticClass:"text-center"},[t._v("Currently Active")]):e("ui-button",{staticClass:"w-full",on:{click:function(e){return t.setAsActive(a.namespace)}}},[t._v("Set as active")])],1)])])])})),0),t._v(" "),e("portal",{attrs:{to:"actions"}},[e("router-link",{staticClass:"button",attrs:{to:{name:"dashboard"}}},[t._v("Go Back")])],1),t._v(" "),e("ui-modal",{key:"confirm_modal",attrs:{name:"confirm",title:"Confirm override"},scopedSlots:t._u([{key:"footer",fn:function(){return[e("ui-button",{attrs:{type:"button",variant:"primary"},on:{click:t.submitUpload}},[t._v("Yes, please!")]),t._v(" "),e("ui-button",{staticClass:"mr-3",attrs:{type:"button"},on:{click:t.cancelUpload}},[t._v("Leave and Discard Changes")])]},proxy:!0}]),model:{value:t.confirmModal,callback:function(e){t.confirmModal=e},expression:"confirmModal"}},[e("p",[t._v("Are you sure you want to override this theme? The existing theme will be discarded.")])])],1)}),[],!1,null,null,null).exports}}]);