"use strict";(self.webpackChunkfusioncms=self.webpackChunkfusioncms||[]).push([[6470],{5320:(a,t,e)=>{e.d(t,{Z:()=>s});const s={methods:{downloadBackup:function(a){window.open("/backups/".concat(a),"_blank")},runBackup:function(){axios.post("/api/backups").then((function(a){return toast("Backup request added to queue!","success")})).catch((function(a){return toast(a.response.data.message,"failed")}))},destroyBackup:function(a){var t=this;axios.delete("/api/backups/".concat(a)).then((function(a){toast("Backp successfully deleted!","success"),t.$router.push("/backups")}))}}}},6470:(a,t,e)=>{e.r(t),e.d(t,{default:()=>o,getModel:()=>n});var s=e(8401);function n(a,t){axios.get("/api/backups/".concat(a)).then((function(a){return t(null,a.data.data)})).catch((function(a){t(new Error("The requested role could not be found"))}))}const c={permission:"backups.view",head:{title:function(){return{inner:this.backup.name||"Loading..."}}},mixins:[e(5320).Z,e(8273).Z],data:function(){return{backup:{},form:!1}},methods:{submit:function(){var a=this;this.form.patch("/api/backups/".concat(this.backup.id)).then((function(t){a.backup=t.data,toast("User successfully updated","success")})).catch((function(a){toast(a.response.data.message,"failed")}))}},beforeRouteEnter:function(a,t,e){n(a.params.backup,(function(a,t){e(a?function(t){t.$router.push("/backup"),toast(a.toString(),"danger")}:function(a){a.backup=t,a.form=new s.Z({name:t.name},!0),a.$emit("updateHead")})}))}};const o=(0,e(1900).Z)(c,(function(){var a=this,t=a._self._c;return t("div",{staticClass:"backups-page"},[t("portal",{attrs:{to:"title"}},[t("page-title",{attrs:{icon:"save"}},[a._v("Backups - "+a._s(a.backup.name))])],1),a._v(" "),t("portal",{attrs:{to:"actions"}},[t("div",{staticClass:"buttons"},[t("ui-button",{key:"go-back-btn",attrs:{to:{name:"backups"},variant:"secondary"}},[a._v("Go Back")]),a._v(" "),t("ui-button",{key:"save-btn",attrs:{variant:"primary",disabled:!a.form.hasChanges},on:{click:function(t){return t.preventDefault(),a.submit.apply(null,arguments)}}},[a._v("Save")])],1)]),a._v(" "),a.form?t("section-card",{attrs:{title:"Backup Information",description:"General information about this backup."}},[t("dl",{staticClass:"detail-list"},[t("ui-input-group",{attrs:{id:"user-name",name:"name",label:"Name",autocomplete:"off",autofocus:"",required:"","has-error":a.form.errors.has("name"),"error-message":a.form.errors.get("name")},model:{value:a.form.name,callback:function(t){a.$set(a.form,"name",t)},expression:"form.name"}}),a._v(" "),t("dt",[a._v("Disk")]),a._v(" "),t("dd",[a._v(a._s(a.backup.disk))]),a._v(" "),t("dt",[a._v("Size")]),a._v(" "),t("dd",[t("code",[a._v(a._s(a.filesize(a.backup.size)))])]),a._v(" "),t("dt",[a._v("Created")]),a._v(" "),t("dd",[a._v(a._s(a.$moment(a.backup.created_at).fromNow()))]),a._v(" "),t("dt",[a._v("Status")]),a._v(" "),t("dd",{staticClass:"flex"},["success"==a.backup.state?t("span",[t("fa-icon",{staticClass:"icon fa-xs text-success-500",attrs:{icon:"circle"}}),a._v(" Success\n                ")],1):a._e(),a._v(" "),"failed"==a.backup.state?t("span",[t("fa-icon",{staticClass:"icon fa-xs text-danger-500",attrs:{icon:"circle"}}),a._v(" Failed\n                ")],1):a._e(),a._v(" "),"in-progress"==a.backup.state?t("span",[t("fa-icon",{staticClass:"icon fa-xs text-orange-500",attrs:{icon:"circle"}}),a._v(" In Progress\n                ")],1):a._e()])],1)]):a._e(),a._v(" "),a.form?t("section-card",{attrs:{title:"Actions",description:"Management actions that can be performed for this backup."}},[t("div",{staticClass:"mb-4"},[t("span",{staticClass:"label"},[a._v("Restore Backup")]),a._v(" "),t("p",{staticClass:"help mb-2"},[a._v("Restore FusionCMS to this backup.")]),a._v(" "),t("ui-button",{directives:[{name:"modal",rawName:"v-modal:restore-backup",value:a.backup,expression:"backup",arg:"restore-backup"}],attrs:{variant:"secondary"},on:{click:function(a){a.preventDefault()}}},[a._v("Restore Backup")])],1),a._v(" "),t("div",{staticClass:"mb-4"},[t("span",{staticClass:"label"},[a._v("Download Backup")]),a._v(" "),t("p",{staticClass:"help mb-2"},[a._v("Download backup zip.")]),a._v(" "),t("ui-button",{attrs:{variant:"secondary"},on:{click:function(t){return t.preventDefault(),a.downloadBackup(a.backup.id)}}},[a._v("Download Backup")])],1),a._v(" "),t("div",{staticClass:"mb-4"},[t("span",{staticClass:"label"},[a._v("Delete Backup")]),a._v(" "),t("p",{staticClass:"help mb-2"},[a._v("Once you delete this backup, there is no going back. Please be certain.")]),a._v(" "),t("ui-button",{directives:[{name:"modal",rawName:"v-modal:delete-backup",arg:"delete-backup"}],attrs:{variant:"danger"}},[a._v("Delete Backup")])],1)]):a._e(),a._v(" "),t("section-card",{attrs:{title:"Backup Log",description:"See what has been happening."}},[a.backup.logs?t("table",{staticClass:"table",attrs:{"aria-live":"polite"}},[t("tr",[t("th",[t("span",{staticClass:"table__heading"},[a._v("Level")])]),a._v(" "),t("th",[t("span",{staticClass:"table__heading"},[a._v("Message")])]),a._v(" "),t("th",[t("span",{staticClass:"table__heading"},[a._v("Happened")])])]),a._v(" "),a._l(a.backup.logs.data,(function(e,s){return t("tr",{key:"log-".concat(s)},[t("td",{attrs:{align:"center"}},[t("span",{staticClass:"column-label"},[a._v("Level")]),a._v("\n                    "+a._s(e.level_name)+"\n                ")]),a._v(" "),t("td",[t("span",{staticClass:"column-label"},[a._v("Message")]),a._v("\n                    "+a._s(e.message)+"\n                ")]),a._v(" "),t("td",{attrs:{align:"center"}},[t("span",{staticClass:"column-label"},[a._v("Happened")]),a._v("\n                    "+a._s(e.happened)+"\n                ")])])}))],2):a._e()]),a._v(" "),t("portal",{attrs:{to:"modals"}},[t("restore-backup-modal"),a._v(" "),t("ui-modal",{key:"delete_backup",attrs:{name:"delete-backup",title:"Delete Backup"}},[t("p",[a._v("Are you sure you want to permenantly delete this backup?")]),a._v(" "),t("template",{slot:"footer"},[t("ui-button",{directives:[{name:"modal",rawName:"v-modal:delete-backup",arg:"delete-backup"}],staticClass:"ml-3",attrs:{variant:"danger"},on:{click:function(t){return a.destroyBackup(a.backup.id)}}},[a._v("Delete")]),a._v(" "),t("ui-button",{directives:[{name:"modal",rawName:"v-modal:delete-backup",arg:"delete-backup"}]},[a._v("Cancel")])],1)],2)],1)],1)}),[],!1,null,null,null).exports}}]);